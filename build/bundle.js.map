{"version":3,"file":"bundle.js","sources":["../node_modules/preact/src/vnode.js","../node_modules/preact/src/options.js","../node_modules/preact/src/h.js","../node_modules/preact/src/util.js","../node_modules/preact/src/constants.js","../node_modules/preact/src/linked-state.js","../node_modules/preact/src/render-queue.js","../node_modules/preact/src/vdom/functional-component.js","../node_modules/preact/src/vdom/index.js","../node_modules/preact/src/dom/index.js","../node_modules/preact/src/dom/recycler.js","../node_modules/preact/src/vdom/diff.js","../node_modules/preact/src/vdom/component-recycler.js","../node_modules/preact/src/vdom/component.js","../node_modules/preact/src/component.js","../node_modules/preact/src/render.js","../src/utils.js","../src/Sidebar/TabBar/Tab/Tab.js","../src/Sidebar/TabBar/TabBar.js","../src/UiKit/Header/index.js","../src/UiKit/Button/index.js","../src/Sidebar/Views/Home/index.js","../src/Sidebar/Views/About/index.js","../src/Sidebar/Views/YourSelection/index.js","../src/Sidebar/Views/Current/index.js","../src/Sidebar/Views/Legend/index.js","../src/Sidebar/Views/Story/index.js","../src/Sidebar/Sidebar.js","../js/state.js","../js/net.js","../js/fun.js","../js/model.js","../js/convo.js","../js/dom.js","../js/render.js","../js/graph.js","../js/main.js","../src/main.js"],"sourcesContent":["/** Virtual DOM Node */\nexport function VNode(nodeName, attributes, children) {\n\t/** @type {string|function} */\n\tthis.nodeName = nodeName;\n\n\t/** @type {object<string>|undefined} */\n\tthis.attributes = attributes;\n\n\t/** @type {array<VNode>|undefined} */\n\tthis.children = children;\n\n\t/** Reference to the given key. */\n\tthis.key = attributes && attributes.key;\n}\n","/** Global options\n *\t@public\n *\t@namespace options {Object}\n */\nexport default {\n\n\t/** If `true`, `prop` changes trigger synchronous component updates.\n\t *\t@name syncComponentUpdates\n\t *\t@type Boolean\n\t *\t@default true\n\t */\n\t//syncComponentUpdates: true,\n\n\t/** Processes all created VNodes.\n\t *\t@param {VNode} vnode\tA newly-created VNode to normalize/process\n\t */\n\t//vnode(vnode) { }\n\n\t/** Hook invoked after a component is mounted. */\n\t// afterMount(component) { }\n\n\t/** Hook invoked after the DOM is updated with a component's latest render. */\n\t// afterUpdate(component) { }\n\n\t/** Hook invoked immediately before a component is unmounted. */\n\t// beforeUnmount(component) { }\n};\n","import { VNode } from './vnode';\nimport options from './options';\n\n\nconst stack = [];\n\nconst EMPTY_CHILDREN = [];\n\n/** JSX/hyperscript reviver\n*\tBenchmarks: https://esbench.com/bench/57ee8f8e330ab09900a1a1a0\n *\t@see http://jasonformat.com/wtf-is-jsx\n *\t@public\n *  @example\n *  /** @jsx h *\\/\n *  import { render, h } from 'preact';\n *  render(<span>foo</span>, document.body);\n */\nexport function h(nodeName, attributes) {\n\tlet children, lastSimple, child, simple, i;\n\tfor (i=arguments.length; i-- > 2; ) {\n\t\tstack.push(arguments[i]);\n\t}\n\tif (attributes && attributes.children) {\n\t\tif (!stack.length) stack.push(attributes.children);\n\t\tdelete attributes.children;\n\t}\n\twhile (stack.length) {\n\t\tif ((child = stack.pop()) instanceof Array) {\n\t\t\tfor (i=child.length; i--; ) stack.push(child[i]);\n\t\t}\n\t\telse if (child!=null && child!==true && child!==false) {\n\t\t\tif (typeof child=='number') child = String(child);\n\t\t\tsimple = typeof child=='string';\n\t\t\tif (simple && lastSimple) {\n\t\t\t\tchildren[children.length-1] += child;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t(children || (children = [])).push(child);\n\t\t\t\tlastSimple = simple;\n\t\t\t}\n\t\t}\n\t}\n\n\tlet p = new VNode(nodeName, attributes || undefined, children || EMPTY_CHILDREN);\n\n\t// if a \"vnode hook\" is defined, pass every created VNode to it\n\tif (options.vnode) options.vnode(p);\n\n\treturn p;\n}\n","/** Copy own-properties from `props` onto `obj`.\n *\t@returns obj\n *\t@private\n */\nexport function extend(obj, props) {\n\tif (props) {\n\t\tfor (let i in props) obj[i] = props[i];\n\t}\n\treturn obj;\n}\n\n\n/** Fast clone. Note: does not filter out non-own properties.\n *\t@see https://esbench.com/bench/56baa34f45df6895002e03b6\n */\nexport function clone(obj) {\n\treturn extend({}, obj);\n}\n\n\n/** Get a deep property value from the given object, expressed in dot-notation.\n *\t@private\n */\nexport function delve(obj, key) {\n\tfor (let p=key.split('.'), i=0; i<p.length && obj; i++) {\n\t\tobj = obj[p[i]];\n\t}\n\treturn obj;\n}\n\n\n/** @private is the given object a Function? */\nexport function isFunction(obj) {\n\treturn 'function'===typeof obj;\n}\n\n\n/** @private is the given object a String? */\nexport function isString(obj) {\n\treturn 'string'===typeof obj;\n}\n\n\n/** Convert a hashmap of CSS classes to a space-delimited className string\n *\t@private\n */\nexport function hashToClassName(c) {\n\tlet str = '';\n\tfor (let prop in c) {\n\t\tif (c[prop]) {\n\t\t\tif (str) str += ' ';\n\t\t\tstr += prop;\n\t\t}\n\t}\n\treturn str;\n}\n\n\n/** Just a memoized String#toLowerCase */\nlet lcCache = {};\nexport const toLowerCase = s => lcCache[s] || (lcCache[s] = s.toLowerCase());\n\n\n/** Call a function asynchronously, as soon as possible.\n *\t@param {Function} callback\n */\nlet resolved = typeof Promise!=='undefined' && Promise.resolve();\nexport const defer = resolved ? (f => { resolved.then(f); }) : setTimeout;\n","// render modes\n\nexport const NO_RENDER = 0;\nexport const SYNC_RENDER = 1;\nexport const FORCE_RENDER = 2;\nexport const ASYNC_RENDER = 3;\n\nexport const EMPTY = {};\n\nexport const ATTR_KEY = typeof Symbol!=='undefined' ? Symbol.for('preactattr') : '__preactattr_';\n\n// DOM properties that should NOT have \"px\" added when numeric\nexport const NON_DIMENSION_PROPS = {\n\tboxFlex:1, boxFlexGroup:1, columnCount:1, fillOpacity:1, flex:1, flexGrow:1,\n\tflexPositive:1, flexShrink:1, flexNegative:1, fontWeight:1, lineClamp:1, lineHeight:1,\n\topacity:1, order:1, orphans:1, strokeOpacity:1, widows:1, zIndex:1, zoom:1\n};\n\n// DOM event types that do not bubble and should be attached via useCapture\nexport const NON_BUBBLING_EVENTS = { blur:1, error:1, focus:1, load:1, resize:1, scroll:1 };\n","import { isString, delve } from './util';\n\n/** Create an Event handler function that sets a given state property.\n *\t@param {Component} component\tThe component whose state should be updated\n *\t@param {string} key\t\t\t\tA dot-notated key path to update in the component's state\n *\t@param {string} eventPath\t\tA dot-notated key path to the value that should be retrieved from the Event or component\n *\t@returns {function} linkedStateHandler\n *\t@private\n */\nexport function createLinkedState(component, key, eventPath) {\n\tlet path = key.split('.');\n\treturn function(e) {\n\t\tlet t = e && e.target || this,\n\t\t\tstate = {},\n\t\t\tobj = state,\n\t\t\tv = isString(eventPath) ? delve(e, eventPath) : t.nodeName ? (t.type.match(/^che|rad/) ? t.checked : t.value) : e,\n\t\t\ti = 0;\n\t\tfor ( ; i<path.length-1; i++) {\n\t\t\tobj = obj[path[i]] || (obj[path[i]] = !i && component.state[path[i]] || {});\n\t\t}\n\t\tobj[path[i]] = v;\n\t\tcomponent.setState(state);\n\t};\n}\n","import options from './options';\nimport { defer } from './util';\nimport { renderComponent } from './vdom/component';\n\n/** Managed queue of dirty components to be re-rendered */\n\n// items/itemsOffline swap on each rerender() call (just a simple pool technique)\nlet items = [];\n\nexport function enqueueRender(component) {\n\tif (!component._dirty && (component._dirty = true) && items.push(component)==1) {\n\t\t(options.debounceRendering || defer)(rerender);\n\t}\n}\n\n\nexport function rerender() {\n\tlet p, list = items;\n\titems = [];\n\twhile ( (p = list.pop()) ) {\n\t\tif (p._dirty) renderComponent(p);\n\t}\n}\n","import { EMPTY } from '../constants';\nimport { getNodeProps } from './index';\nimport { isFunction } from '../util';\n\n\n/** Check if a VNode is a reference to a stateless functional component.\n *\tA function component is represented as a VNode whose `nodeName` property is a reference to a function.\n *\tIf that function is not a Component (ie, has no `.render()` method on a prototype), it is considered a stateless functional component.\n *\t@param {VNode} vnode\tA VNode\n *\t@private\n */\nexport function isFunctionalComponent(vnode) {\n\tlet nodeName = vnode && vnode.nodeName;\n\treturn nodeName && isFunction(nodeName) && !(nodeName.prototype && nodeName.prototype.render);\n}\n\n\n\n/** Construct a resultant VNode from a VNode referencing a stateless functional component.\n *\t@param {VNode} vnode\tA VNode with a `nodeName` property that is a reference to a function.\n *\t@private\n */\nexport function buildFunctionalComponent(vnode, context) {\n\treturn vnode.nodeName(getNodeProps(vnode), context || EMPTY);\n}\n","import { clone, isString, isFunction, toLowerCase } from '../util';\nimport { isFunctionalComponent } from './functional-component';\n\n\n/** Check if two nodes are equivalent.\n *\t@param {Element} node\n *\t@param {VNode} vnode\n *\t@private\n */\nexport function isSameNodeType(node, vnode) {\n\tif (isString(vnode)) {\n\t\treturn node instanceof Text;\n\t}\n\tif (isString(vnode.nodeName)) {\n\t\treturn !node._componentConstructor && isNamedNode(node, vnode.nodeName);\n\t}\n\tif (isFunction(vnode.nodeName)) {\n\t\treturn (node._componentConstructor ? node._componentConstructor===vnode.nodeName : true) || isFunctionalComponent(vnode);\n\t}\n}\n\n\nexport function isNamedNode(node, nodeName) {\n\treturn node.normalizedNodeName===nodeName || toLowerCase(node.nodeName)===toLowerCase(nodeName);\n}\n\n\n/**\n * Reconstruct Component-style `props` from a VNode.\n * Ensures default/fallback values from `defaultProps`:\n * Own-properties of `defaultProps` not present in `vnode.attributes` are added.\n * @param {VNode} vnode\n * @returns {Object} props\n */\nexport function getNodeProps(vnode) {\n\tlet props = clone(vnode.attributes);\n\tprops.children = vnode.children;\n\n\tlet defaultProps = vnode.nodeName.defaultProps;\n\tif (defaultProps) {\n\t\tfor (let i in defaultProps) {\n\t\t\tif (props[i]===undefined) {\n\t\t\t\tprops[i] = defaultProps[i];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn props;\n}\n","import { NON_DIMENSION_PROPS, NON_BUBBLING_EVENTS } from '../constants';\nimport options from '../options';\nimport { toLowerCase, isString, isFunction, hashToClassName } from '../util';\n\n\n\n\n/** Removes a given DOM Node from its parent. */\nexport function removeNode(node) {\n\tlet p = node.parentNode;\n\tif (p) p.removeChild(node);\n}\n\n\n/** Set a named attribute on the given Node, with special behavior for some names and event handlers.\n *\tIf `value` is `null`, the attribute/handler will be removed.\n *\t@param {Element} node\tAn element to mutate\n *\t@param {string} name\tThe name/key to set, such as an event or attribute name\n *\t@param {any} old\tThe last value that was set for this name/node pair\n *\t@param {any} value\tAn attribute value, such as a function to be used as an event handler\n *\t@param {Boolean} isSvg\tAre we currently diffing inside an svg?\n *\t@private\n */\nexport function setAccessor(node, name, old, value, isSvg) {\n\n\tif (name==='className') name = 'class';\n\n\tif (name==='class' && value && typeof value==='object') {\n\t\tvalue = hashToClassName(value);\n\t}\n\n\tif (name==='key') {\n\t\t// ignore\n\t}\n\telse if (name==='class' && !isSvg) {\n\t\tnode.className = value || '';\n\t}\n\telse if (name==='style') {\n\t\tif (!value || isString(value) || isString(old)) {\n\t\t\tnode.style.cssText = value || '';\n\t\t}\n\t\tif (value && typeof value==='object') {\n\t\t\tif (!isString(old)) {\n\t\t\t\tfor (let i in old) if (!(i in value)) node.style[i] = '';\n\t\t\t}\n\t\t\tfor (let i in value) {\n\t\t\t\tnode.style[i] = typeof value[i]==='number' && !NON_DIMENSION_PROPS[i] ? (value[i]+'px') : value[i];\n\t\t\t}\n\t\t}\n\t}\n\telse if (name==='dangerouslySetInnerHTML') {\n\t\tif (value) node.innerHTML = value.__html || '';\n\t}\n\telse if (name[0]=='o' && name[1]=='n') {\n\t\tlet l = node._listeners || (node._listeners = {});\n\t\tname = toLowerCase(name.substring(2));\n\t\t// @TODO: this might be worth it later, un-breaks focus/blur bubbling in IE9:\n\t\t// if (node.attachEvent) name = name=='focus'?'focusin':name=='blur'?'focusout':name;\n\t\tif (value) {\n\t\t\tif (!l[name]) node.addEventListener(name, eventProxy, !!NON_BUBBLING_EVENTS[name]);\n\t\t}\n\t\telse if (l[name]) {\n\t\t\tnode.removeEventListener(name, eventProxy, !!NON_BUBBLING_EVENTS[name]);\n\t\t}\n\t\tl[name] = value;\n\t}\n\telse if (name!=='list' && name!=='type' && !isSvg && name in node) {\n\t\tsetProperty(node, name, value==null ? '' : value);\n\t\tif (value==null || value===false) node.removeAttribute(name);\n\t}\n\telse {\n\t\tlet ns = isSvg && name.match(/^xlink\\:?(.+)/);\n\t\tif (value==null || value===false) {\n\t\t\tif (ns) node.removeAttributeNS('http://www.w3.org/1999/xlink', toLowerCase(ns[1]));\n\t\t\telse node.removeAttribute(name);\n\t\t}\n\t\telse if (typeof value!=='object' && !isFunction(value)) {\n\t\t\tif (ns) node.setAttributeNS('http://www.w3.org/1999/xlink', toLowerCase(ns[1]), value);\n\t\t\telse node.setAttribute(name, value);\n\t\t}\n\t}\n}\n\n\n/** Attempt to set a DOM property to the given value.\n *\tIE & FF throw for certain property-value combinations.\n */\nfunction setProperty(node, name, value) {\n\ttry {\n\t\tnode[name] = value;\n\t} catch (e) { }\n}\n\n\n/** Proxy an event to hooked event handlers\n *\t@private\n */\nfunction eventProxy(e) {\n\treturn this._listeners[e.type](options.event && options.event(e) || e);\n}\n","import { toLowerCase } from '../util';\nimport { removeNode } from './index';\n\n/** DOM node pool, keyed on nodeName. */\n\nconst nodes = {};\n\nexport function collectNode(node) {\n\tremoveNode(node);\n\n\tif (node instanceof Element) {\n\t\tnode._component = node._componentConstructor = null;\n\n\t\tlet name = node.normalizedNodeName || toLowerCase(node.nodeName);\n\t\t(nodes[name] || (nodes[name] = [])).push(node);\n\t}\n}\n\n\nexport function createNode(nodeName, isSvg) {\n\tlet name = toLowerCase(nodeName),\n\t\tnode = nodes[name] && nodes[name].pop() || (isSvg ? document.createElementNS('http://www.w3.org/2000/svg', nodeName) : document.createElement(nodeName));\n\tnode.normalizedNodeName = name;\n\treturn node;\n}\n","import { ATTR_KEY } from '../constants';\nimport { isString, isFunction } from '../util';\nimport { isSameNodeType, isNamedNode } from './index';\nimport { isFunctionalComponent, buildFunctionalComponent } from './functional-component';\nimport { buildComponentFromVNode } from './component';\nimport { setAccessor, removeNode } from '../dom/index';\nimport { createNode, collectNode } from '../dom/recycler';\nimport { unmountComponent } from './component';\nimport options from '../options';\n\n\n/** Queue of components that have been mounted and are awaiting componentDidMount */\nexport const mounts = [];\n\n/** Diff recursion count, used to track the end of the diff cycle. */\nexport let diffLevel = 0;\n\n/** Global flag indicating if the diff is currently within an SVG */\nlet isSvgMode = false;\n\n/** Global flag indicating if the diff is performing hydration */\nlet hydrating = false;\n\n/** Invoke queued componentDidMount lifecycle methods */\nexport function flushMounts() {\n\tlet c;\n\twhile ((c=mounts.pop())) {\n\t\tif (options.afterMount) options.afterMount(c);\n\t\tif (c.componentDidMount) c.componentDidMount();\n\t}\n}\n\n\n/** Apply differences in a given vnode (and it's deep children) to a real DOM Node.\n *\t@param {Element} [dom=null]\t\tA DOM node to mutate into the shape of the `vnode`\n *\t@param {VNode} vnode\t\t\tA VNode (with descendants forming a tree) representing the desired DOM structure\n *\t@returns {Element} dom\t\t\tThe created/mutated element\n *\t@private\n */\nexport function diff(dom, vnode, context, mountAll, parent, componentRoot) {\n\t// diffLevel having been 0 here indicates initial entry into the diff (not a subdiff)\n\tif (!diffLevel++) {\n\t\t// when first starting the diff, check if we're diffing an SVG or within an SVG\n\t\tisSvgMode = parent && typeof parent.ownerSVGElement!=='undefined';\n\n\t\t// hydration is inidicated by the existing element to be diffed not having a prop cache\n\t\thydrating = dom && !(ATTR_KEY in dom);\n\t}\n\n\tlet ret = idiff(dom, vnode, context, mountAll);\n\n\t// append the element if its a new parent\n\tif (parent && ret.parentNode!==parent) parent.appendChild(ret);\n\n\t// diffLevel being reduced to 0 means we're exiting the diff\n\tif (!--diffLevel) {\n\t\thydrating = false;\n\t\t// invoke queued componentDidMount lifecycle methods\n\t\tif (!componentRoot) flushMounts();\n\t}\n\n\treturn ret;\n}\n\n\nfunction idiff(dom, vnode, context, mountAll) {\n\tlet ref = vnode && vnode.attributes && vnode.attributes.ref;\n\n\n\t// Resolve ephemeral Pure Functional Components\n\twhile (isFunctionalComponent(vnode)) {\n\t\tvnode = buildFunctionalComponent(vnode, context);\n\t}\n\n\n\t// empty values (null & undefined) render as empty Text nodes\n\tif (vnode==null) vnode = '';\n\n\n\t// Fast case: Strings create/update Text nodes.\n\tif (isString(vnode)) {\n\t\t// update if it's already a Text node\n\t\tif (dom && dom instanceof Text && dom.parentNode) {\n\t\t\tif (dom.nodeValue!=vnode) {\n\t\t\t\tdom.nodeValue = vnode;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t// it wasn't a Text node: replace it with one and recycle the old Element\n\t\t\tif (dom) recollectNodeTree(dom);\n\t\t\tdom = document.createTextNode(vnode);\n\t\t}\n\n\t\treturn dom;\n\t}\n\n\n\t// If the VNode represents a Component, perform a component diff.\n\tif (isFunction(vnode.nodeName)) {\n\t\treturn buildComponentFromVNode(dom, vnode, context, mountAll);\n\t}\n\n\n\tlet out = dom,\n\t\tnodeName = String(vnode.nodeName),\t// @TODO this masks undefined component errors as `<undefined>`\n\t\tprevSvgMode = isSvgMode,\n\t\tvchildren = vnode.children;\n\n\n\t// SVGs have special namespace stuff.\n\t// This tracks entering and exiting that namespace when descending through the tree.\n\tisSvgMode = nodeName==='svg' ? true : nodeName==='foreignObject' ? false : isSvgMode;\n\n\n\tif (!dom) {\n\t\t// case: we had no element to begin with\n\t\t// - create an element with the nodeName from VNode\n\t\tout = createNode(nodeName, isSvgMode);\n\t}\n\telse if (!isNamedNode(dom, nodeName)) {\n\t\t// case: Element and VNode had different nodeNames\n\t\t// - need to create the correct Element to match VNode\n\t\t// - then migrate children from old to new\n\n\t\tout = createNode(nodeName, isSvgMode);\n\n\t\t// move children into the replacement node\n\t\twhile (dom.firstChild) out.appendChild(dom.firstChild);\n\n\t\t// if the previous Element was mounted into the DOM, replace it inline\n\t\tif (dom.parentNode) dom.parentNode.replaceChild(out, dom);\n\n\t\t// recycle the old element (skips non-Element node types)\n\t\trecollectNodeTree(dom);\n\t}\n\n\n\tlet fc = out.firstChild,\n\t\tprops = out[ATTR_KEY];\n\n\t// Attribute Hydration: if there is no prop cache on the element,\n\t// ...create it and populate it with the element's attributes.\n\tif (!props) {\n\t\tout[ATTR_KEY] = props = {};\n\t\tfor (let a=out.attributes, i=a.length; i--; ) props[a[i].name] = a[i].value;\n\t}\n\n\t// Optimization: fast-path for elements containing a single TextNode:\n\tif (!hydrating && vchildren && vchildren.length===1 && typeof vchildren[0]==='string' && fc && fc instanceof Text && !fc.nextSibling) {\n\t\tif (fc.nodeValue!=vchildren[0]) {\n\t\t\tfc.nodeValue = vchildren[0];\n\t\t}\n\t}\n\t// otherwise, if there are existing or new children, diff them:\n\telse if (vchildren && vchildren.length || fc) {\n\t\tinnerDiffNode(out, vchildren, context, mountAll, !!props.dangerouslySetInnerHTML);\n\t}\n\n\n\t// Apply attributes/props from VNode to the DOM Element:\n\tdiffAttributes(out, vnode.attributes, props);\n\n\n\t// invoke original ref (from before resolving Pure Functional Components):\n\tif (ref) {\n\t\t(props.ref = ref)(out);\n\t}\n\n\tisSvgMode = prevSvgMode;\n\n\treturn out;\n}\n\n\n/** Apply child and attribute changes between a VNode and a DOM Node to the DOM.\n *\t@param {Element} dom\t\tElement whose children should be compared & mutated\n *\t@param {Array} vchildren\tArray of VNodes to compare to `dom.childNodes`\n *\t@param {Object} context\t\tImplicitly descendant context object (from most recent `getChildContext()`)\n *\t@param {Boolean} mountAll\n *\t@param {Boolean} absorb\t\tIf `true`, consumes externally created elements similar to hydration\n */\nfunction innerDiffNode(dom, vchildren, context, mountAll, absorb) {\n\tlet originalChildren = dom.childNodes,\n\t\tchildren = [],\n\t\tkeyed = {},\n\t\tkeyedLen = 0,\n\t\tmin = 0,\n\t\tlen = originalChildren.length,\n\t\tchildrenLen = 0,\n\t\tvlen = vchildren && vchildren.length,\n\t\tj, c, vchild, child;\n\n\tif (len) {\n\t\tfor (let i=0; i<len; i++) {\n\t\t\tlet child = originalChildren[i],\n\t\t\t\tprops = child[ATTR_KEY],\n\t\t\t\tkey = vlen ? ((c = child._component) ? c.__key : props ? props.key : null) : null;\n\t\t\tif (key!=null) {\n\t\t\t\tkeyedLen++;\n\t\t\t\tkeyed[key] = child;\n\t\t\t}\n\t\t\telse if (hydrating || absorb || props || child instanceof Text) {\n\t\t\t\tchildren[childrenLen++] = child;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (vlen) {\n\t\tfor (let i=0; i<vlen; i++) {\n\t\t\tvchild = vchildren[i];\n\t\t\tchild = null;\n\n\t\t\t// if (isFunctionalComponent(vchild)) {\n\t\t\t// \tvchild = buildFunctionalComponent(vchild);\n\t\t\t// }\n\n\t\t\t// attempt to find a node based on key matching\n\t\t\tlet key = vchild.key;\n\t\t\tif (key!=null) {\n\t\t\t\tif (keyedLen && key in keyed) {\n\t\t\t\t\tchild = keyed[key];\n\t\t\t\t\tkeyed[key] = undefined;\n\t\t\t\t\tkeyedLen--;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// attempt to pluck a node of the same type from the existing children\n\t\t\telse if (!child && min<childrenLen) {\n\t\t\t\tfor (j=min; j<childrenLen; j++) {\n\t\t\t\t\tc = children[j];\n\t\t\t\t\tif (c && isSameNodeType(c, vchild)) {\n\t\t\t\t\t\tchild = c;\n\t\t\t\t\t\tchildren[j] = undefined;\n\t\t\t\t\t\tif (j===childrenLen-1) childrenLen--;\n\t\t\t\t\t\tif (j===min) min++;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// morph the matched/found/created DOM child to match vchild (deep)\n\t\t\tchild = idiff(child, vchild, context, mountAll);\n\n\t\t\tif (child && child!==dom) {\n\t\t\t\tif (i>=len) {\n\t\t\t\t\tdom.appendChild(child);\n\t\t\t\t}\n\t\t\t\telse if (child!==originalChildren[i]) {\n\t\t\t\t\tif (child===originalChildren[i+1]) {\n\t\t\t\t\t\tremoveNode(originalChildren[i]);\n\t\t\t\t\t}\n\t\t\t\t\tdom.insertBefore(child, originalChildren[i] || null);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\n\tif (keyedLen) {\n\t\tfor (let i in keyed) if (keyed[i]) recollectNodeTree(keyed[i]);\n\t}\n\n\t// remove orphaned children\n\twhile (min<=childrenLen) {\n\t\tchild = children[childrenLen--];\n\t\tif (child) recollectNodeTree(child);\n\t}\n}\n\n\n\n/** Recursively recycle (or just unmount) a node an its descendants.\n *\t@param {Node} node\t\t\t\t\t\tDOM node to start unmount/removal from\n *\t@param {Boolean} [unmountOnly=false]\tIf `true`, only triggers unmount lifecycle, skips removal\n */\nexport function recollectNodeTree(node, unmountOnly) {\n\tlet component = node._component;\n\tif (component) {\n\t\t// if node is owned by a Component, unmount that component (ends up recursing back here)\n\t\tunmountComponent(component, !unmountOnly);\n\t}\n\telse {\n\t\t// If the node's VNode had a ref function, invoke it with null here.\n\t\t// (this is part of the React spec, and smart for unsetting references)\n\t\tif (node[ATTR_KEY] && node[ATTR_KEY].ref) node[ATTR_KEY].ref(null);\n\n\t\tif (!unmountOnly) {\n\t\t\tcollectNode(node);\n\t\t}\n\n\t\t// Recollect/unmount all children.\n\t\t// - we use .lastChild here because it causes less reflow than .firstChild\n\t\t// - it's also cheaper than accessing the .childNodes Live NodeList\n\t\tlet c;\n\t\twhile ((c=node.lastChild)) recollectNodeTree(c, unmountOnly);\n\t}\n}\n\n\n\n/** Apply differences in attributes from a VNode to the given DOM Element.\n *\t@param {Element} dom\t\tElement with attributes to diff `attrs` against\n *\t@param {Object} attrs\t\tThe desired end-state key-value attribute pairs\n *\t@param {Object} old\t\t\tCurrent/previous attributes (from previous VNode or element's prop cache)\n */\nfunction diffAttributes(dom, attrs, old) {\n\t// remove attributes no longer present on the vnode by setting them to undefined\n\tlet name;\n\tfor (name in old) {\n\t\tif (!(attrs && name in attrs) && old[name]!=null) {\n\t\t\tsetAccessor(dom, name, old[name], old[name] = undefined, isSvgMode);\n\t\t}\n\t}\n\n\t// add new & update changed attributes\n\tif (attrs) {\n\t\tfor (name in attrs) {\n\t\t\tif (name!=='children' && name!=='innerHTML' && (!(name in old) || attrs[name]!==(name==='value' || name==='checked' ? dom[name] : old[name]))) {\n\t\t\t\tsetAccessor(dom, name, old[name], old[name] = attrs[name], isSvgMode);\n\t\t\t}\n\t\t}\n\t}\n}\n","import { Component } from '../component';\n\n/** Retains a pool of Components for re-use, keyed on component name.\n *\tNote: since component names are not unique or even necessarily available, these are primarily a form of sharding.\n *\t@private\n */\nconst components = {};\n\n\nexport function collectComponent(component) {\n\tlet name = component.constructor.name,\n\t\tlist = components[name];\n\tif (list) list.push(component);\n\telse components[name] = [component];\n}\n\n\nexport function createComponent(Ctor, props, context) {\n\tlet inst = new Ctor(props, context),\n\t\tlist = components[Ctor.name];\n\tComponent.call(inst, props, context);\n\tif (list) {\n\t\tfor (let i=list.length; i--; ) {\n\t\t\tif (list[i].constructor===Ctor) {\n\t\t\t\tinst.nextBase = list[i].nextBase;\n\t\t\t\tlist.splice(i, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn inst;\n}\n","import { SYNC_RENDER, NO_RENDER, FORCE_RENDER, ASYNC_RENDER, ATTR_KEY } from '../constants';\nimport options from '../options';\nimport { isFunction, clone, extend } from '../util';\nimport { enqueueRender } from '../render-queue';\nimport { getNodeProps } from './index';\nimport { diff, mounts, diffLevel, flushMounts, recollectNodeTree } from './diff';\nimport { isFunctionalComponent, buildFunctionalComponent } from './functional-component';\nimport { createComponent, collectComponent } from './component-recycler';\nimport { removeNode } from '../dom/index';\n\n\n\n/** Set a component's `props` (generally derived from JSX attributes).\n *\t@param {Object} props\n *\t@param {Object} [opts]\n *\t@param {boolean} [opts.renderSync=false]\tIf `true` and {@link options.syncComponentUpdates} is `true`, triggers synchronous rendering.\n *\t@param {boolean} [opts.render=true]\t\t\tIf `false`, no render will be triggered.\n */\nexport function setComponentProps(component, props, opts, context, mountAll) {\n\tif (component._disable) return;\n\tcomponent._disable = true;\n\n\tif ((component.__ref = props.ref)) delete props.ref;\n\tif ((component.__key = props.key)) delete props.key;\n\n\tif (!component.base || mountAll) {\n\t\tif (component.componentWillMount) component.componentWillMount();\n\t}\n\telse if (component.componentWillReceiveProps) {\n\t\tcomponent.componentWillReceiveProps(props, context);\n\t}\n\n\tif (context && context!==component.context) {\n\t\tif (!component.prevContext) component.prevContext = component.context;\n\t\tcomponent.context = context;\n\t}\n\n\tif (!component.prevProps) component.prevProps = component.props;\n\tcomponent.props = props;\n\n\tcomponent._disable = false;\n\n\tif (opts!==NO_RENDER) {\n\t\tif (opts===SYNC_RENDER || options.syncComponentUpdates!==false || !component.base) {\n\t\t\trenderComponent(component, SYNC_RENDER, mountAll);\n\t\t}\n\t\telse {\n\t\t\tenqueueRender(component);\n\t\t}\n\t}\n\n\tif (component.__ref) component.__ref(component);\n}\n\n\n\n/** Render a Component, triggering necessary lifecycle events and taking High-Order Components into account.\n *\t@param {Component} component\n *\t@param {Object} [opts]\n *\t@param {boolean} [opts.build=false]\t\tIf `true`, component will build and store a DOM node if not already associated with one.\n *\t@private\n */\nexport function renderComponent(component, opts, mountAll, isChild) {\n\tif (component._disable) return;\n\n\tlet skip, rendered,\n\t\tprops = component.props,\n\t\tstate = component.state,\n\t\tcontext = component.context,\n\t\tpreviousProps = component.prevProps || props,\n\t\tpreviousState = component.prevState || state,\n\t\tpreviousContext = component.prevContext || context,\n\t\tisUpdate = component.base,\n\t\tnextBase = component.nextBase,\n\t\tinitialBase = isUpdate || nextBase,\n\t\tinitialChildComponent = component._component,\n\t\tinst, cbase;\n\n\t// if updating\n\tif (isUpdate) {\n\t\tcomponent.props = previousProps;\n\t\tcomponent.state = previousState;\n\t\tcomponent.context = previousContext;\n\t\tif (opts!==FORCE_RENDER\n\t\t\t&& component.shouldComponentUpdate\n\t\t\t&& component.shouldComponentUpdate(props, state, context) === false) {\n\t\t\tskip = true;\n\t\t}\n\t\telse if (component.componentWillUpdate) {\n\t\t\tcomponent.componentWillUpdate(props, state, context);\n\t\t}\n\t\tcomponent.props = props;\n\t\tcomponent.state = state;\n\t\tcomponent.context = context;\n\t}\n\n\tcomponent.prevProps = component.prevState = component.prevContext = component.nextBase = null;\n\tcomponent._dirty = false;\n\n\tif (!skip) {\n\t\tif (component.render) rendered = component.render(props, state, context);\n\n\t\t// context to pass to the child, can be updated via (grand-)parent component\n\t\tif (component.getChildContext) {\n\t\t\tcontext = extend(clone(context), component.getChildContext());\n\t\t}\n\n\t\twhile (isFunctionalComponent(rendered)) {\n\t\t\trendered = buildFunctionalComponent(rendered, context);\n\t\t}\n\n\t\tlet childComponent = rendered && rendered.nodeName,\n\t\t\ttoUnmount, base;\n\n\t\tif (isFunction(childComponent)) {\n\t\t\t// set up high order component link\n\n\t\t\tlet childProps = getNodeProps(rendered);\n\t\t\tinst = initialChildComponent;\n\n\t\t\tif (inst && inst.constructor===childComponent && childProps.key==inst.__key) {\n\t\t\t\tsetComponentProps(inst, childProps, SYNC_RENDER, context);\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttoUnmount = inst;\n\n\t\t\t\tinst = createComponent(childComponent, childProps, context);\n\t\t\t\tinst.nextBase = inst.nextBase || nextBase;\n\t\t\t\tinst._parentComponent = component;\n\t\t\t\tcomponent._component = inst;\n\t\t\t\tsetComponentProps(inst, childProps, NO_RENDER, context);\n\t\t\t\trenderComponent(inst, SYNC_RENDER, mountAll, true);\n\t\t\t}\n\n\t\t\tbase = inst.base;\n\t\t}\n\t\telse {\n\t\t\tcbase = initialBase;\n\n\t\t\t// destroy high order component link\n\t\t\ttoUnmount = initialChildComponent;\n\t\t\tif (toUnmount) {\n\t\t\t\tcbase = component._component = null;\n\t\t\t}\n\n\t\t\tif (initialBase || opts===SYNC_RENDER) {\n\t\t\t\tif (cbase) cbase._component = null;\n\t\t\t\tbase = diff(cbase, rendered, context, mountAll || !isUpdate, initialBase && initialBase.parentNode, true);\n\t\t\t}\n\t\t}\n\n\t\tif (initialBase && base!==initialBase && inst!==initialChildComponent) {\n\t\t\tlet baseParent = initialBase.parentNode;\n\t\t\tif (baseParent && base!==baseParent) {\n\t\t\t\tbaseParent.replaceChild(base, initialBase);\n\n\t\t\t\tif (!toUnmount) {\n\t\t\t\t\tinitialBase._component = null;\n\t\t\t\t\trecollectNodeTree(initialBase);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (toUnmount) {\n\t\t\tunmountComponent(toUnmount, base!==initialBase);\n\t\t}\n\n\t\tcomponent.base = base;\n\t\tif (base && !isChild) {\n\t\t\tlet componentRef = component,\n\t\t\t\tt = component;\n\t\t\twhile ((t=t._parentComponent)) {\n\t\t\t\t(componentRef = t).base = base;\n\t\t\t}\n\t\t\tbase._component = componentRef;\n\t\t\tbase._componentConstructor = componentRef.constructor;\n\t\t}\n\t}\n\n\tif (!isUpdate || mountAll) {\n\t\tmounts.unshift(component);\n\t}\n\telse if (!skip) {\n\t\tif (component.componentDidUpdate) {\n\t\t\tcomponent.componentDidUpdate(previousProps, previousState, previousContext);\n\t\t}\n\t\tif (options.afterUpdate) options.afterUpdate(component);\n\t}\n\n\tlet cb = component._renderCallbacks, fn;\n\tif (cb) while ( (fn = cb.pop()) ) fn.call(component);\n\n\tif (!diffLevel && !isChild) flushMounts();\n}\n\n\n\n/** Apply the Component referenced by a VNode to the DOM.\n *\t@param {Element} dom\tThe DOM node to mutate\n *\t@param {VNode} vnode\tA Component-referencing VNode\n *\t@returns {Element} dom\tThe created/mutated element\n *\t@private\n */\nexport function buildComponentFromVNode(dom, vnode, context, mountAll) {\n\tlet c = dom && dom._component,\n\t\toriginalComponent = c,\n\t\toldDom = dom,\n\t\tisDirectOwner = c && dom._componentConstructor===vnode.nodeName,\n\t\tisOwner = isDirectOwner,\n\t\tprops = getNodeProps(vnode);\n\twhile (c && !isOwner && (c=c._parentComponent)) {\n\t\tisOwner = c.constructor===vnode.nodeName;\n\t}\n\n\tif (c && isOwner && (!mountAll || c._component)) {\n\t\tsetComponentProps(c, props, ASYNC_RENDER, context, mountAll);\n\t\tdom = c.base;\n\t}\n\telse {\n\t\tif (originalComponent && !isDirectOwner) {\n\t\t\tunmountComponent(originalComponent, true);\n\t\t\tdom = oldDom = null;\n\t\t}\n\n\t\tc = createComponent(vnode.nodeName, props, context);\n\t\tif (dom && !c.nextBase) {\n\t\t\tc.nextBase = dom;\n\t\t\t// passing dom/oldDom as nextBase will recycle it if unused, so bypass recycling on L241:\n\t\t\toldDom = null;\n\t\t}\n\t\tsetComponentProps(c, props, SYNC_RENDER, context, mountAll);\n\t\tdom = c.base;\n\n\t\tif (oldDom && dom!==oldDom) {\n\t\t\toldDom._component = null;\n\t\t\trecollectNodeTree(oldDom);\n\t\t}\n\t}\n\n\treturn dom;\n}\n\n\n\n/** Remove a component from the DOM and recycle it.\n *\t@param {Element} dom\t\t\tA DOM node from which to unmount the given Component\n *\t@param {Component} component\tThe Component instance to unmount\n *\t@private\n */\nexport function unmountComponent(component, remove) {\n\tif (options.beforeUnmount) options.beforeUnmount(component);\n\n\t// console.log(`${remove?'Removing':'Unmounting'} component: ${component.constructor.name}`);\n\tlet base = component.base;\n\n\tcomponent._disable = true;\n\n\tif (component.componentWillUnmount) component.componentWillUnmount();\n\n\tcomponent.base = null;\n\n\t// recursively tear down & recollect high-order component children:\n\tlet inner = component._component;\n\tif (inner) {\n\t\tunmountComponent(inner, remove);\n\t}\n\telse if (base) {\n\t\tif (base[ATTR_KEY] && base[ATTR_KEY].ref) base[ATTR_KEY].ref(null);\n\n\t\tcomponent.nextBase = base;\n\n\t\tif (remove) {\n\t\t\tremoveNode(base);\n\t\t\tcollectComponent(component);\n\t\t}\n\t\tlet c;\n\t\twhile ((c=base.lastChild)) recollectNodeTree(c, !remove);\n\t\t// removeOrphanedChildren(base.childNodes, true);\n\t}\n\n\tif (component.__ref) component.__ref(null);\n\tif (component.componentDidUnmount) component.componentDidUnmount();\n}\n","import { FORCE_RENDER } from './constants';\nimport { extend, clone, isFunction } from './util';\nimport { createLinkedState } from './linked-state';\nimport { renderComponent } from './vdom/component';\nimport { enqueueRender } from './render-queue';\n\n/** Base Component class, for the ES6 Class method of creating Components\n *\t@public\n *\n *\t@example\n *\tclass MyFoo extends Component {\n *\t\trender(props, state) {\n *\t\t\treturn <div />;\n *\t\t}\n *\t}\n */\nexport function Component(props, context) {\n\t/** @private */\n\tthis._dirty = true;\n\t// /** @public */\n\t// this._disableRendering = false;\n\t// /** @public */\n\t// this.prevState = this.prevProps = this.prevContext = this.base = this.nextBase = this._parentComponent = this._component = this.__ref = this.__key = this._linkedStates = this._renderCallbacks = null;\n\t/** @public */\n\tthis.context = context;\n\t/** @type {object} */\n\tthis.props = props;\n\t/** @type {object} */\n\tif (!this.state) this.state = {};\n}\n\n\nextend(Component.prototype, {\n\n\t/** Returns a `boolean` value indicating if the component should re-render when receiving the given `props` and `state`.\n\t *\t@param {object} nextProps\n\t *\t@param {object} nextState\n\t *\t@param {object} nextContext\n\t *\t@returns {Boolean} should the component re-render\n\t *\t@name shouldComponentUpdate\n\t *\t@function\n\t */\n\t// shouldComponentUpdate() {\n\t// \treturn true;\n\t// },\n\n\n\t/** Returns a function that sets a state property when called.\n\t *\tCalling linkState() repeatedly with the same arguments returns a cached link function.\n\t *\n\t *\tProvides some built-in special cases:\n\t *\t\t- Checkboxes and radio buttons link their boolean `checked` value\n\t *\t\t- Inputs automatically link their `value` property\n\t *\t\t- Event paths fall back to any associated Component if not found on an element\n\t *\t\t- If linked value is a function, will invoke it and use the result\n\t *\n\t *\t@param {string} key\t\tThe path to set - can be a dot-notated deep key\n\t *\t@param {string} [eventPath]\tIf set, attempts to find the new state value at a given dot-notated path within the object passed to the linkedState setter.\n\t *\t@returns {function} linkStateSetter(e)\n\t *\n\t *\t@example Update a \"text\" state value when an input changes:\n\t *\t\t<input onChange={ this.linkState('text') } />\n\t *\n\t *\t@example Set a deep state value on click\n\t *\t\t<button onClick={ this.linkState('touch.coords', 'touches.0') }>Tap</button\n\t */\n\tlinkState(key, eventPath) {\n\t\tlet c = this._linkedStates || (this._linkedStates = {});\n\t\treturn c[key+eventPath] || (c[key+eventPath] = createLinkedState(this, key, eventPath));\n\t},\n\n\n\t/** Update component state by copying properties from `state` to `this.state`.\n\t *\t@param {object} state\t\tA hash of state properties to update with new values\n\t */\n\tsetState(state, callback) {\n\t\tlet s = this.state;\n\t\tif (!this.prevState) this.prevState = clone(s);\n\t\textend(s, isFunction(state) ? state(s, this.props) : state);\n\t\tif (callback) (this._renderCallbacks = (this._renderCallbacks || [])).push(callback);\n\t\tenqueueRender(this);\n\t},\n\n\n\t/** Immediately perform a synchronous re-render of the component.\n\t *\t@private\n\t */\n\tforceUpdate() {\n\t\trenderComponent(this, FORCE_RENDER);\n\t},\n\n\n\t/** Accepts `props` and `state`, and returns a new Virtual DOM tree to build.\n\t *\tVirtual DOM is generally constructed via [JSX](http://jasonformat.com/wtf-is-jsx).\n\t *\t@param {object} props\t\tProps (eg: JSX attributes) received from parent element/component\n\t *\t@param {object} state\t\tThe component's current state\n\t *\t@param {object} context\t\tContext object (if a parent component has provided context)\n\t *\t@returns VNode\n\t */\n\trender() {}\n\n});\n","import { diff } from './vdom/diff';\n\n/** Render JSX into a `parent` Element.\n *\t@param {VNode} vnode\t\tA (JSX) VNode to render\n *\t@param {Element} parent\t\tDOM element to render into\n *\t@param {Element} [merge]\tAttempt to re-use an existing DOM tree rooted at `merge`\n *\t@public\n *\n *\t@example\n *\t// render a div into <body>:\n *\trender(<div id=\"hello\">hello!</div>, document.body);\n *\n *\t@example\n *\t// render a \"Thing\" component into #foo:\n *\tconst Thing = ({ name }) => <span>{ name }</span>;\n *\trender(<Thing name=\"one\" />, document.querySelector('#foo'));\n */\nexport function render(vnode, parent, merge) {\n\treturn diff(merge, vnode, {}, false, parent);\n}\n","// for making conditional class making easier in react\nexport const classMaker = (a, b, class_1, class_2) => a === b ? class_1: class_2 ","import { h, render, Component } from 'preact';\nimport './Tab.css'\nimport {classMaker} from '../../../utils';\n\nconst Tab = ({id, name, currentView, icon, changeView}) => {\n\n  const tabClasses = classMaker(currentView, id, 'Tab selected', 'Tab')\n  const iconClasses = classMaker(currentView, id, `${icon} tab-icon selected`, `${icon} tab-icon`)\n\n  return (\n    <button class={tabClasses} onClick={() => changeView(id)}>\n      <icon class={iconClasses} />\n      {name}\n    </button>\n  );\n};\n\nexport default Tab;","import { h, render, Component } from 'preact';\nimport './TabBar.css'\nimport Tab from './Tab/Tab';\n\n/**\n * List to iterate over and generate tab commponents with.\n */\nconst tabs = [\n  {name: \"Home\", id: \"home\", icon: \"fa fa-home\"},\n  {name: \"Add A Story\", id: \"story\", icon: \"fa fa-commenting-o\"},\n  {name: \"Filters / Legend\", id: \"legend\", icon: \"fa fa-map-marker\"},\n  {name: \"Currently Showing\", id: \"currently_showing\", icon: \"fa fa-eye\"},\n  {name: \"Your Selection\", id: \"your_selection\", icon: \"fa fa-commenting\"},\n  {name: \"About\", id:\"about\", icon: \"fa fa-clone\"},\n]\n\n\n/**\n * Constructs the menu tabs that are clickable. \n */\nconst TabBar = props => {\n  const renderTabs = () => {\n    return tabs.map(tab => {\n      return <Tab {...tab} currentView={props.currentView} changeView={props.changeView} />\n    })\n  }\n\n  return (\n    <div class=\"Tabbar\">\n      {renderTabs()}\n      <div class=\"Tabbar__fillspace\"></div>\n    </div>\n\n  );\n};\n\nexport default TabBar;","import { h, render } from 'preact';\nimport './styles.css'\n\nconst Header = props => {\n  const genClassName = () => {\n    switch(props.type){\n      case 'large':\n        return 'Header large'\n      default: \n        return 'Header'\n    }\n  }\n\n\n  return (\n    <div class={genClassName()} style={props.style}>\n     {props.children} \n    </div>\n  );\n};\n\nexport default Header;","import { h, render } from 'preact';\nimport './styles.css'\n\nconst Button = props => {\n  const genClassName = () => {\n    switch(props.type){\n      case 'large':\n        return 'Button large'\n      default: \n        return 'Button'\n    }\n  }\n\n\n  return (\n    <button \n      onClick={props.onClick}\n      class={genClassName()} \n      style={props.style}>\n     {props.children} \n    </button>\n  );\n};\n\nexport default Button;","import { h, render } from 'preact';\nimport './styles.css'\nimport Header from '../../../UiKit/Header/index';\nimport Button from '../../../UiKit/Button/index';\n\nconst Home = () => {\n  return (\n    <div>\n\n      {/* General Welcome Message  */}\n      <section class=\"Home__welcome\">\n        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Veniam quidem voluptatem laudantium fuga iste nulla eligendi mollitia velit amet laborum, quia blanditiis rerum, eius nobis quod ipsam sit recusandae ratione!\n      </section>\n\n      {/* Add a story CTA */}\n      <section class=\"Home__cta-addstory\">\n        <p>We'd love to hear your stories!</p>\n        <Button>Add a story ▶</Button>\n      </section>\n\n      {/* Recently Added Stories */}\n      <section class=\"Home__recent\">\n        {/* TODO: create a h3 with underline component */}\n        <Header>Recently Added Stories</Header>\n      </section>\n\n    </div>\n  );\n};\n\nexport default Home;","import { h, render } from 'preact';\nimport Header from '../../../UiKit/Header/index';\n\nconst About = () => {\n  return (\n    <div>\n      <Header>About</Header>\n      <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nesciunt culpa, iste repellendus a, provident saepe! Illum exercitationem, ipsa! Magnam consequatur, nam, atque tempore nihil perspiciatis? Reiciendis sequi est reprehenderit veniam.</p>\n      <p>Doloribus, perferendis ipsa veritatis vitae consequuntur ut autem! Repellendus odit cum cupiditate ab eum laudantium, voluptas hic libero eaque distinctio dolor, nesciunt error eligendi tenetur itaque earum aut ipsa aliquid.</p>\n      <p>Quaerat doloremque suscipit aperiam, velit, perspiciatis mollitia officia ad vero reprehenderit veritatis dolores blanditiis reiciendis iusto quisquam, quasi, incidunt ab hic. Fugit necessitatibus tempore cupiditate aspernatur quaerat. Itaque, labore, provident.</p>\n      <p>Aspernatur, error. Consequatur eos, laudantium unde vitae ipsam voluptatem neque ea quod et velit voluptatum nihil, aperiam. Quod tenetur, rem consequuntur itaque dignissimos saepe est? Modi laudantium delectus tempora ut.</p>\n      <p>Unde a neque laudantium beatae voluptas tenetur, expedita consequuntur nemo quos dolorem quasi, amet quo perspiciatis! Aspernatur nesciunt modi perspiciatis ea nisi iste quam voluptate veritatis. Facilis minus aperiam, perspiciatis.</p>\n\n      <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nesciunt culpa, iste repellendus a, provident saepe! Illum exercitationem, ipsa! Magnam consequatur, nam, atque tempore nihil perspiciatis? Reiciendis sequi est reprehenderit veniam.</p>\n      <p>Doloribus, perferendis ipsa veritatis vitae consequuntur ut autem! Repellendus odit cum cupiditate ab eum laudantium, voluptas hic libero eaque distinctio dolor, nesciunt error eligendi tenetur itaque earum aut ipsa aliquid.</p>\n      <p>Quaerat doloremque suscipit aperiam, velit, perspiciatis mollitia officia ad vero reprehenderit veritatis dolores blanditiis reiciendis iusto quisquam, quasi, incidunt ab hic. Fugit necessitatibus tempore cupiditate aspernatur quaerat. Itaque, labore, provident.</p>\n      <p>Aspernatur, error. Consequatur eos, laudantium unde vitae ipsam voluptatem neque ea quod et velit voluptatum nihil, aperiam. Quod tenetur, rem consequuntur itaque dignissimos saepe est? Modi laudantium delectus tempora ut.</p>\n      <p>Unde a neque laudantium beatae voluptas tenetur, expedita consequuntur nemo quos dolorem quasi, amet quo perspiciatis! Aspernatur nesciunt modi perspiciatis ea nisi iste quam voluptate veritatis. Facilis minus aperiam, perspiciatis.</p>\n     <Header> Documentation </Header> \n    </div>\n  );\n};\n\nexport default About;","import { h, render } from 'preact';\nimport Header from '../../../UiKit/Header/index';\nimport Button from '../../../UiKit/Button/index';\n\nconst YourSelection = () => {\n  return (\n    <div>\n      <Header>Your Selection</Header>\n\n      {/* Add a story CTA */}\n      <section class=\"YourSelection__cta-addstory\">\n        <p>Ready to add your own story?</p>\n        <Button>Add a story ▶</Button>\n      </section>\n\n    </div>\n  );\n};\n\nexport default YourSelection;","import { h, render } from 'preact';\nimport Header from '../../../UiKit/Header/index';\n\nconst Current = () => {\n  return (\n    <div>\n      <Header>Currently Showing</Header>\n    </div>\n  );\n};\n\nexport default Current;","import { h, render } from 'preact';\n\nconst Legend = () => {\n  return (\n    <div>\n      Im the LEGEND page\n    </div>\n  );\n};\n\nexport default Legend;","import { h, render } from 'preact';\n\nconst Story = () => {\n  return (\n    <div>\n      Im the STORY page\n    </div>\n  );\n};\n\nexport default Story;","import { h, render, Component } from 'preact';\nimport './Sidebar.css'\nimport TabBar from './TabBar/TabBar';\nimport Home from './Views/Home/index';\nimport About from './Views/About/index';\nimport YourSelection from './Views/YourSelection/index';\nimport Current from './Views/Current/index';\nimport Legend from './Views/Legend/index';\nimport Story from './Views/Story/index';\n\n/**\n * Sidebar layout and state\n */\nclass Sidebar extends Component {\n  state = {\n    currentView: 'home'\n  }\n\n  changeView = (view_id) => {\n    this.setState({\n      currentView: view_id \n    })\n  }\n\n  renderSelectedView = () => {\n    switch(this.state.currentView){\n      case 'home':\n        return <Home />\n      case 'story':\n        return <Story />\n      case 'legend':\n        return <Legend />\n      case 'currently_showing':\n        return <Current />\n      case 'your_selection':\n        return <YourSelection />\n      case 'about':\n        return <About />\n      default:\n        return <Home />\n    }\n  }\n\n  render() {\n    return (\n      <aside class=\"Sidebar\">\n\n        {/* Render different views based on which section is selected*/}\n        <section class=\"Sidebar__container\">\n          <h3 class=\"Sidebar__header\">AMC Ripple Map</h3>\n          {this.renderSelectedView()}\n        </section>\n\n        <TabBar currentView={this.state.currentView} changeView={this.changeView} />\n\n      </aside>\n    );\n  }\n}\n\nexport default Sidebar;","const state = {}\nexport default state\n\nstate.tags = [] // THINK: default to ['plain']?\nstate.facts = []\nstate.tagkeys = {}\nstate.query = {}\n\nstate.safe_mode = false\nstate.loading = true // TODO: fix this\n\nstate.all_edges        = true  // awkward... :(\nstate.admin_mode       = false // yep another hack w00t\nstate.my_maxyear       = 2017  // total hackery...\nstate.my_minyear       = 2008  // hack hack hack\nstate.show_labels      = false // yup\nstate.current_year     = 2017  // more hacks\nstate.filter_sentences = false // awkward... :(\nstate.ring_radius      = 40    // lalala\n","import {G} from 'graph'\nimport state from 'state'\n\nexport {add_to_server_facts, persist, get_facts_from_server}\n\n\n\n\nfunction add_to_server_facts(type, live_item) {\n  if(state.loading)\n    return undefined\n\n  /*\n\n   data model:\n   user: id\n   action: add/remove/edit\n   type: node/edge\n   tags: [...]\n   [maybe other stats can live here?]\n   data:\n     node: {id, name, type, cat...}\n     edge: {_in, _out, type, label}\n\n   */\n\n  // var item = JSON.parse(JSON.stringify(live_item))\n  var item = Object.keys(live_item).reduce(function(acc, key) {\n        if(['_in', '_out'].indexOf(key) !== -1) return acc\n        acc[key] = live_item[key]\n        return acc\n      }, {})\n\n  if(type === 'edge') {\n    item._out = live_item._out._id\n    item._in  = live_item._in._id\n  }\n\n  // FIXME: present splash page of some kind\n\n  var fact = { email: state.email\n             , action: 'add'\n             , type: type\n             , tags: state.tags\n             , data: item\n             }\n\n  send_data_to_server(fact)\n}\n\nfunction persist() {\n  // THINK: do we still need localstorage caching?\n  Dagoba.persist(G, 'rripplemap')\n}\n\npersist = debounce(persist, 1000)\n\nfunction debounce(func, wait, immediate) {\n  // via underscore, needs cleaning\n  // Returns a function, that, as long as it continues to be invoked, will not\n  // be triggered. The function will be called after it stops being called for\n  // N milliseconds. If `immediate` is passed, trigger the function on the\n  // leading edge, instead of the trailing.\n\n  var timeout\n  return function() {\n    var context = this, args = arguments\n    var later = function() {\n          timeout = null\n          if (!immediate) func.apply(context, args)\n        }\n    var callNow = immediate && !timeout\n    clearTimeout(timeout)\n    timeout = setTimeout(later, wait)\n    if (callNow) func.apply(context, args)\n  }\n}\n\nfunction send_data_to_server(data, cb) {\n  var url = 'http://ripplemap.io:8888'\n\n  if(state.safe_mode === 'daring') {\n    url = 'http://localhost:8888'\n  }\n  else if(state.safe_mode) {\n    return console.log(G)\n  }\n\n  fetch(url, { method: 'post'\n             , body: JSON.stringify(data)\n  }).then(function(response) {\n    return response.json()\n  }).then(function(result) {\n    if(cb)\n      cb(result)\n  })\n}\n\nfunction get_facts_from_server(cb) {\n  var url = 'http://ripplemap.io:8888'\n\n  // local shunt for airplane mode\n  if(state.safe_mode === 'local')\n    return cb(JSON.parse(localStorage['DAGOBA::ripmapdata']))\n\n  if(state.safe_mode === 'daring') {\n    url = 'http://localhost:8888'\n  }\n\n  fetch(url, {\n    method: 'get'\n  }).then(function(response) {\n    return response.json()\n  }).then(function(data) {\n    cb(data)\n  }).catch(function(err) {\n    console.log('lalalal', err)\n  })\n}\n","// Some fun functions that help or something\n\nexport {noop, not, eq, unique, strip, comp, prop, cp_prop, clone, truncate, push_it, pipe, error}\n\n\nfunction noop() {}\n\nfunction not(fun) {return function() {return !fun.apply(null, arguments)}}\n\nfunction eq(attr, val) {return function(obj) {return obj[attr] === val}}\n\nfunction unique(v, k, list) {return list.indexOf(v) === k}\n\nfunction strip(attr) {return function(obj) { delete obj[attr]; return obj }}\n\nfunction comp(f, g) {return function() { var args = [].slice.call(arguments); return f(g.apply(null, args)) }}\n\nfunction prop (attr) {return function(obj) {return obj[attr]}}\n\nfunction cp_prop(from_attr, to_attr) {return function(obj) {obj[to_attr] = obj[from_attr]; return obj}}\n\nfunction clone(obj) {return JSON.parse(JSON.stringify(obj))}\n\nfunction truncate(str, to) {\n  if(!to || str.length <= to) return str\n  return str.substr(0, to-2) + '...'\n}\n\nfunction push_it(list, key, val) {\n  if(!list[key])\n    return list[key] = [val]\n\n  list[key].push(val)\n  return list[key]\n}\n\nfunction pipe() {\n  var all_funs = [].slice.call(arguments)\n\n  function magic_pipe(data) {\n    var funs = all_funs.slice()\n    var fun\n\n    function inner() {\n      while(fun = funs.shift()) {\n        if(fun.async) {              // fun is async\n          return fun.async(data, cb)\n        } else {                     // fun is a function\n          data = fun(data)\n        }\n      }\n    }\n\n    function cb(new_data) {\n      data = new_data\n      inner()\n    }\n\n    // TODO: this should return a promise for data\n    inner()\n    return true\n  }\n\n  return magic_pipe\n}\n\nfunction error(mess) {\n  console.log(arguments, mess)\n}\n","import {G} from 'graph'\nimport {error, clone} from 'fun'\nimport {add_to_server_facts} from 'net'\n\nexport const cats = {} // ripplemap categories\nexport {add_thing, add_action, add_edge}\n\n/* INTERFACES FOR RIPPLE MODEL\n *\n * There are four categories: Thing, Action, Effect, and Happening\n *\n * Each category has multiple types associated with it. Each node has a category and type.\n *\n * Each node also tracks its cron, the adding user, and some type of 'confidence interval' (later)\n *\n * Each edge has a type, which is its label. Nodes expect edges of certain types.\n *\n */\n\ncats.thing = {}\ncats.action = {}\ncats.effect = {}\ncats.happening = {}\n\nfunction get_node(catstr, typestr, props) {\n  var node = convert_props(props)\n\n  var cat = cats[catstr]\n  if(!cat)\n    return error('that is not a valid cat', catstr)\n\n  var type = cat[typestr]\n  if(!type)\n    return error('that is not a valid ' + catstr + ' type', typestr)\n\n  // TODO: check props again the cattype's property list\n\n  node.cat  = catstr\n  node.type = typestr\n  node.name = props.name || typestr // TODO: remove (or something...)\n\n  return node\n}\n\nfunction add_alias(catstr, typestr, alias) {\n  // TODO: check alias\n\n  // add an alias to anything\n  var cat = cats[catstr]\n  if(!cat)\n    return error('Invalid cat', catstr)\n\n  var type = cat[typestr]\n  if(!type)\n    return error('That is not a valid thing type', typestr)\n\n  // add alias\n  type.aliases.push(alias)\n\n  // add type to list\n  cat[alias] = type\n\n  // THINK: alias rules?\n}\n\n\nfunction add_thing(type, props, persist) {\n  var node = get_node('thing', type, props)\n  if(!node) return false\n\n  node.priority = 1 // bbq???\n\n  add_to_graph('node', node)\n  if(persist)\n    add_to_server_facts('node', node)\n\n  return node\n}\n\nfunction add_action(type, props, persist) {\n  var node = get_node('action', type, props)\n  if(!node) return false\n\n  node.priority = 1 // bbq???\n\n  // TODO: check props against type (what does this mean?)\n\n  add_to_graph('node', node)\n  if(persist)\n    add_to_server_facts('node', node)\n\n  return node\n}\n\nfunction add_effect(type, props, persist) {\n  var node = get_node('effect', type, props)\n  if(!node) return undefined\n\n  node.priority = 0.5 // bbq???\n\n  add_to_graph('node', node)\n  if(persist)\n    add_to_server_facts('node', node)\n}\n\nfunction add_happening(type, props, persist) {\n  var node = get_node('happening', type, props)\n  if(!node) return undefined\n\n  node.priority = 0.4\n\n  add_to_graph('node', node)\n  if(persist)\n    add_to_server_facts('node', node)\n}\n\n\n\nfunction new_thing_type(type, properties) {\n  // TODO: valid type?\n\n  // does this type exist already?\n  var cattype = cats.thing[type]\n  if(cattype)\n    return error('That thing type already exists', type)\n\n  // manually create\n  // THINK: should we copy properties here?\n  cattype = {type: type}\n  cattype.aliases = [] // THINK: but if you do don't override properties.aliases\n\n  // add properties.cc\n  cattype.cc = properties.cc || {}\n\n  // add default props for all things\n  cattype.props = {} // THINK: get props from properties.props?\n  cattype.props.name = {}\n  cattype.props.start = {} // THINK: these have both fuzziness and confidence issues (how sure is the user of the time, how sure are we of the user)\n  cattype.props.end = {}\n\n  // TODO: add questions\n\n  // put in place\n  cats.thing[type] = cattype\n\n  // add properties.aliases\n  if(properties.aliases) {\n    properties.aliases.forEach(function(alias) {\n      add_alias('thing', type, alias)\n    })\n  }\n}\n\nfunction new_action_type(type, properties) {\n  // TODO: valid type?\n\n  // does this type exist already?\n  var cattype = cats.action[type]\n  if(cattype)\n    return error('That action type already exists', type)\n\n  // manually create\n  // THINK: should we copy properties here?\n  cattype = {type: type}\n\n  // add properties.edges and default edges\n  cattype.edges = properties.edges || {}\n  cattype.edges.did = {dir: 'in',  plural: 0, label: 'did', types: ['person'], aliases: []}\n  cattype.edges.to  = {dir: 'in',  plural: 0, label: 'to',  types: ['effect'], aliases: []}\n  cattype.edges.the = {dir: 'out', plural: 0, label: 'the', types: ['thing'],  aliases: []}\n\n  // add default props for all actions\n  cattype.props = {} // THINK: get props from properties.props?\n  cattype.aliases = [] // THINK: but if you do don't override properties.aliases\n\n  // TODO: add questions\n\n  // put in place\n  cats.action[type] = cattype\n\n  // add properties.aliases\n  if(properties.aliases) {\n    properties.aliases.forEach(function(alias) {\n      add_alias('action', type, alias)\n    })\n  }\n}\n\nfunction new_effect_type(type, properties) {\n  // TODO: valid type?\n\n  // does this type exist already?\n  var cattype = cats.effect[type]\n  if(cattype)\n    return error('That effect type already exists', type)\n\n  // manually create\n  // THINK: should we copy properties here?\n  cattype = {type: type}\n\n  // add properties.edges and default edges\n  cattype.edges = properties.edges || {}\n  cattype.edges.to     = {dir: 'out', plural: 0, label: 'to',     types: ['action'],    aliases: []}\n  cattype.edges.by     = {dir: 'in',  plural: 1, label: 'by',     types: ['thing'],     aliases: []}\n  cattype.edges.was    = {dir: 'in',  plural: 1, label: 'was',    types: ['person'],    aliases: []}\n  cattype.edges.during = {dir: 'out', plural: 0, label: 'during', types: ['happening'], aliases: []}\n\n  // add default props for all effects\n  cattype.props = {} // THINK: get props from properties.props?\n  cattype.aliases = [] // THINK: but if you do don't override properties.aliases\n\n  // TODO: add questions\n\n  // put in place\n  cats.effect[type] = cattype\n\n  // add properties.aliases\n  if(properties.aliases) {\n    properties.aliases.forEach(function(alias) {\n      add_alias('effect', type, alias)\n    })\n  }\n}\n\nfunction new_happening_type(type, properties) {\n  // what properties do happenings have?\n  // an edge type can have an alias for storytelling purposes\n\n  // TODO: valid type?\n\n  // does this type exist already?\n  var cattype = cats.happening[type]\n  if(cattype)\n    return error('That happening type already exists', type)\n\n  // manually create\n  // THINK: should we copy properties here?\n  cattype = {type: type}\n\n  // add properties.edges and default edges\n  cattype.edges = properties.edges || {}\n  cattype.edges.at     = {dir: 'out', plural: 0, label: 'at',     types: ['place',   'event'], aliases: []}\n  cattype.edges.the    = {dir: 'out', plural: 1, label: 'the',    types: ['outcome', 'event'], aliases: []}\n  cattype.edges.did    = {dir: 'in',  plural: 1, label: 'did',    types: ['person'],           aliases: []}\n  cattype.edges.during = {dir: 'in',  plural: 0, label: 'during', types: ['effect'],           aliases: []}\n\n  // add default props for all happenings\n  cattype.props = {} // THINK: get props from properties.props?\n  cattype.aliases = [] // THINK: but if you do don't override properties.aliases\n\n  // TODO: add questions\n\n  // put in place\n  cats.happening[type] = cattype\n\n  // add properties.aliases\n  if(properties.aliases) {\n    properties.aliases.forEach(function(alias) {\n      add_alias('happening', type, alias)\n    })\n  }\n}\n\n\nfunction new_edge_type(type, properties) {\n  // what properties do edges have?\n}\n\nfunction add_edge(type, from, to, props, persist) {\n  var edge = {}\n\n  // check from and to\n  // check type against from and to interfaces\n  // publish in dagoba + persist\n\n  edge = convert_props(props)\n  edge._in = to\n  edge._out = from\n  edge.type = type\n  edge.label = type\n\n  // THINK: if Dagoba supported proper subgraphs, we could have RM.facts and RM.G and keep them fully in sync, instead of limiting RM.G to just the \"viewable\" facts. we'll need a new RM.GG or something for the currently viewable subgraph. this would also help with all the duplicate node warning messages, cut down on allocations, and allow a pipeline based around building new graphs (or extending/syncing the main graph from the factbase). so facts_to_graph would take a graph and some facts and put them together, or something. or as you add new facts they're automatically ramified into the graph. or fizzlemorts.\n\n  add_to_graph('edge', edge)\n  if(persist)\n    add_to_server_facts('edge', edge)\n}\n\nfunction import_graph(V, E) {\n  // add V things\n  // add V happenings\n  // add edges\n}\n\nfunction extract_story(V, E) {\n  // given a subgraph, extract a \"story\"\n}\n\nfunction story_to_text(story) {\n  // what is a story?\n  // how do we turn it into text?\n}\n\nfunction subgraph_of(thing1, thing2) {\n  // find all the paths between them, and their attached bits\n}\n\n\n// SET UP CATEGORIES AND EDGES\n\nnew_thing_type('person',  {})\nnew_thing_type('org',     {cc: ['org']})\nnew_thing_type('place',   {cc: ['place', 'event']})\nnew_thing_type('event',   {cc: ['event', 'outcome'], timerange: true}) // already has start and end, so... ?\nnew_thing_type('outcome', {cc: ['outcome'], aliases: ['artwork', 'session']}) // local vs ubiquitous outcomes -- they're structurally different\n\nnew_action_type('pass',      {aliases: []})\nnew_action_type('join',      {aliases: []})\nnew_action_type('leave',     {aliases: []})\nnew_action_type('create',    {aliases: []})\nnew_action_type('attend',    {aliases: ['participate in']})\nnew_action_type('manage',    {aliases: ['run', 'lead', 'facilitate', 'coordinate', 'organize']})\nnew_action_type('assist',    {aliases: ['help', 'host', 'contribute']})\nnew_action_type('present',   {aliases: []})\nnew_action_type('represent', {aliases: []})\nnew_action_type('fund',      {aliases: []})\nnew_action_type('inspire',   {aliases: []})\nnew_action_type('invite',    {aliases: []})\n\nnew_effect_type('inspire',   {aliases: ['influenced']})\nnew_effect_type('convince',  {aliases: ['ask']})\nnew_effect_type('introduce', {aliases: ['meet']})\n\nnew_happening_type('conversation', {aliases: []})\nnew_happening_type('experience',   {aliases: ['see', 'hear', 'watch', 'attend']})\n\n\n\n// MODEL HELPERS\n\n\nfunction add_to_graph(type, item) {\n  if(type === 'node') {\n    // TODO: this is kind of a hack, but also kind of not\n    if(!item._id)\n      item._id = get_new_id()\n    G.addVertex(item)\n  }\n\n  if(type === 'edge') {\n    G.addEdge(item)\n  }\n}\n\nfunction get_new_id() {\n  // TODO: swap this out for maybe a mongo_id implementation\n  return (\"\" + Math.random()).slice(2)\n}\n\nfunction convert_props(props) {\n  if(typeof props !== 'object')\n    return {}\n\n  if(Array.isArray(props))\n    return {}\n\n  return clone(props)\n}\n","import {add_thing, add_action, add_edge} from 'model'\nimport * as dom from 'dom'\nimport {G} from 'graph'\nimport {render} from 'render'\nimport {error} from 'fun'\n\n\nexport let convo = new_conversation()\nexport {join_conversation}\n\nfunction join_conversation(conversation) {\n  var conversation = conversation || convo\n\n  var wants = conversation.current.slots[0].key\n  var value = dom.el(wants).value\n\n  convo = fulfill_desire(conversation, value)\n\n  return convo\n}\n\nfunction new_sentence() {\n  var slots = [ {key: 'subject', type: 'word', cat: 'thing'}\n              , {key: 'verb', type: 'word', cat: 'action'}\n              , {key: 'object', type: 'word', cat: 'thing'}\n              , {key: 'date', type: 'date'}\n              ]\n  return {slots: slots, filled: []}\n}\n\nfunction new_conversation() {\n  var sentence = new_sentence()\n  return {sentences: [sentence], current: sentence}\n}\n\nfunction fulfill_desire(conversation, value) {\n  var conversation = conversation || convo\n\n  var sentence = give_word(conversation.current, value)\n\n  // TODO: allow multi-sentence conversations\n\n\n  if(!sentence.slots.length) {\n    var subject, verb, object, date\n    sentence.filled.forEach(function(slot) {\n      if(slot.type === 'gettype') {\n        var thing = add_thing(slot.value, {name: slot.name}, true)\n        if(slot.oldkey === 'subject') subject = thing\n        if(slot.oldkey === 'object' ) object  = thing\n      }\n      else if(slot.type === 'date') {\n        date = slot.value\n      }\n      else if(slot.key === 'subject') {\n        subject = slot.word\n      }\n      else if(slot.key === 'object') {\n        object = slot.word\n      }\n      else if(slot.key === 'verb') {\n        verb = (slot.word||{}).type || slot.value\n      }\n    })\n\n    if(subject && verb && object) {\n      verb = add_action(verb, {time: new Date(date).getTime() }, true)\n      add_edge('the', verb._id, object._id, 0, true)\n      add_edge('did', subject._id, verb._id, 0, true)\n    }\n\n    // start over\n    // TODO: show the sentence\n    conversation = new_conversation()\n    render() // THINK: this should queue or something... rAF?\n  }\n\n  return conversation\n}\n\nfunction give_word(sentence, value) {\n  var slot = sentence.slots.shift()\n  if(!slot)\n    return error('This sentence is finished')\n\n  // TODO: check this logic modularly\n  if(slot.type === 'word') {\n    var word = G.v({name: value, cat: slot.cat}).run()[0]\n    if(word) {\n      slot.word = word\n    }\n  }\n\n  if(slot.cat === 'thing') {\n    if(slot.type === 'word') {\n      if(!slot.word) {\n        sentence.slots.unshift({key: 'type', type: 'gettype', name: value, cat: slot.cat, oldkey: slot.key})\n      }\n    }\n    else if(slot.type === 'gettype') {\n      // var nameslot = sentence.filled[sentence.filled.length-1]\n    }\n  }\n\n  // fix it in post\n  slot.value = value\n  sentence.filled.push(slot)\n\n  return sentence\n}\n","// this does some dom things\n\nimport state from 'state'\nimport {G, addtag, removetag} from 'graph'\nimport {join_conversation} from 'convo'\nimport {error} from 'fun'\nimport {persist} from 'net'\nimport {render, whatsnext} from 'render'\n\nexport {set_el, append_el}\n\nexport const el = function() {\n  const els = {}\n  return function(el_id) {\n    // NOTE: removing caching for now to deal with vdom\n    // if(els[el_id])\n    //   return els[el_id]\n    els[el_id] = document.getElementById(el_id) || {}\n    return els[el_id]\n  }\n}()\n\nfunction set_el(el_id, val) {\n  el(el_id).innerHTML = val\n}\n\nfunction append_el(el_id, val) {\n  el(el_id).innerHTML += val\n}\n\n\n\n// LOGIN/ORG/TAG STUFF\n\nexport function login(e) {\n  e.preventDefault()\n  state.email = el('email').value\n  el('login').classList.add('hide')\n  el('storytime').classList.remove('hide')\n}\n\n// SOME HIGHLIGHTING OR SOMETHING\n\nvar highlight_fun, highlight_target\n\nexport function activate_highlighter() {\n  highlight_fun = el('sentences').addEventListener('mousemove', highlighter)\n}\n\nexport function deactivate_highlighter() {\n  el('sentences').removeEventListener('mousemove', highlight_fun)\n}\n\nfunction highlighter(e) {\n  for(var t=e.target; t && t.matches; t = t.parentNode) {\n    if(t.matches('.sentence')) {\n      if(highlight_target === t)\n        return undefined\n\n      highlight_target = t\n      var ids = [].slice.call(t.children).map(node => node.dataset.id).filter(Boolean)\n      var fun = function(v) {return ~ids.indexOf(v._id)}\n      // ids.forEach(id => G.v(id).run()[0].highlight = true)\n      // render()\n      highlight(fun)\n      return undefined\n    }\n  }\n}\n\nfunction highlight(o_or_f) {\n  var current = G.v({highlight: true}).run()\n  current.forEach(function(node) {\n    // node.highlight = false\n    delete node.highlight // better when collapsing\n  })\n\n  if(!o_or_f) {\n    render()\n    return undefined\n  }\n\n  if(typeof o_or_f === 'function') {\n    current = G.v().filter(o_or_f).run()\n  } else {\n    current = G.v(o_or_f).run()\n  }\n\n  current.forEach(function(node) {\n    node.highlight = true\n  })\n\n  render()\n}\n\n\n// INTERACTIONS & DOM BINDINGS\n\nexport function click_tagnames(ev) {\n  ev.preventDefault()\n  var target = ev.target\n  var tag = target.innerText\n  if(!tag) return undefined\n  removetag(tag)\n}\n\nexport function mouseover_tagnames(ev) {\n  var target = ev.target\n  var tag = target.innerText\n\n  if(!tag)\n    return undefined\n\n  if(highlight_target === tag)\n    return undefined\n\n  highlight_target = tag\n  highlight(function(v) { return ~v.tags.indexOf(tag) })\n}\n\nexport function mouseout_tagnames(ev) {\n  if(!highlight_target)\n    return undefined\n\n  highlight_target = false\n  highlight()\n}\n\nexport function global_keydown(ev) {\n  // TODO: clean this up (prevent span hijacking)\n  if( ev.target.tagName === 'SPAN'\n   || ev.target.tagName === 'INPUT'\n   || ev.target.tagName === 'SELECT'\n   || ev.target.tagName === 'TEXTAREA'\n    )\n    return true\n\n  var key = ev.keyCode || ev.which\n\n  // var key_a = 97\n  var key_e = 69\n  var key_f = 70\n  var key_l = 76\n  var key_n = 78\n  var key_p = 80\n  // var key_s = 115\n  var tilde = 126\n  var larro = 37\n  var uarro = 38\n  var rarro = 39\n  var darro = 40\n  // var langl = 60\n  // var rangl = 62\n\n  if(key === larro || key === darro || key === key_p) {\n    ev.preventDefault()\n    if(state.current_year <= state.my_minyear) return false\n    state.current_year--\n    render()\n  }\n\n  if(key === rarro || key === uarro || key === key_n) {\n    ev.preventDefault()\n    if(state.current_year >= state.my_maxyear) return false\n    state.current_year++\n    render()\n  }\n\n  if(key === key_f) {\n    state.filter_sentences = !state.filter_sentences\n    render()\n  }\n\n  if(key === key_e) {\n    state.all_edges = !state.all_edges\n    render()\n  }\n\n  if(key === key_l) {\n    state.show_labels = !state.show_labels\n    render()\n  }\n\n  if(key === tilde) {\n    state.admin_mode = !state.admin_mode\n    render()\n  }\n}\n\nexport function submit_addtag(ev) {\n  ev.preventDefault()\n  addtag(el('othertags').value)\n}\n\nexport function keyup_sentences(ev) {\n  // var key = ev.keyCode || ev.which\n  var span = ev.target\n  var type = span.classList.contains('edge') ? 'edge' : 'cat'\n  var val = span.textContent\n  var id = span.getAttribute('data-id')\n\n  // TODO: trap return for special effects\n  // TODO: maybe trap tab also\n\n  // ev.preventDefault()\n\n  // handle the node case\n  if(type === 'cat' && id && val) {\n    var node = G.vertexIndex[id]\n    if(node && node.name !== val) {\n      // update the name/label in the real graph\n      node.name = val\n      pub(id)\n    }\n  }\n\n  // handle the edge case\n  if(type === 'edge') {\n    var id1 = span.getAttribute('data-id1')\n    var id2 = span.getAttribute('data-id2')\n\n    var node1 = G.vertexIndex[id1]\n    var edges = node1._in.concat(node1._out)\n    var edge = edges.filter\n      (function(edge)\n        {return ( edge._in._id === id1 && edge._out._id === id2 )\n             || ( edge._in._id === id2 && edge._out._id === id1 ) })[0]\n\n    if(!edge) return undefined\n\n    edge.label = val\n    edge.type = val\n\n    // pub(id1 + '-' + id2)\n    // Dagoba.persist(G, 'rripplemap')\n    persist()\n  }\n\n  function pub(id) {\n    // publish the change\n    // Dagoba.persist(G, 'rripplemap')\n    persist()\n\n    // update all other sentences\n    var spans = document.querySelectorAll('span.node-' + id)\n    for(var i = 0; i < spans.length; i++) {\n      if(spans[i] !== span)\n        spans[i].textContent = val\n    }\n\n    // rerender the graph\n    render(0)\n  }\n\n}\n\nexport function click_sentences(ev) {\n  var target = ev.target\n  if(target.nodeName !== 'BUTTON')\n    return true\n\n  var id = target.getAttribute('data-id')\n  var node = G.vertexIndex[id]\n\n  if(!node)\n    return error('That node does not exist')\n\n  if(node.cat === 'action') { // remove \"sentence\"\n    G.removeVertex(node)\n  }\n  else {\n    G.removeVertex(node) // THINK: is this really reasonable?\n  }\n\n  persist()\n  render()\n}\n\nexport function submit_convo(ev) {\n  ev.preventDefault()\n\n  whatsnext(G, join_conversation())\n\n  return false\n}\n","import {G} from 'graph'\nimport {eq, prop, clone, truncate, push_it, pipe} from 'fun'\nimport * as dom from 'dom'\nimport {convo as conversation} from 'convo'\nimport {cats} from 'model'\nimport state from 'state'\n\nexport {init, render, render_all, whatsnext}\n\n\nconst ctx = dom.el('ripples').getContext('2d')\n\nvar viz_pipe, word_pipe\n\n\n// RENDER PIPELINE\n\nfunction init() {\n  // TODO: consider a workflow for managing this tripartite pipeline, so we can auto-cache etc\n  viz_pipe = pipe( mod('data', sg_compact)\n                 , mod('data', likenamed)\n                 , mod('data', cluster)\n                 , mod('data', Dagoba.cloneflat)\n                   // layout:\n                 , set_year\n                 , data_to_graph\n                 , add_fakes\n                 , set_coords\n                 , set_score\n                 , minimize_edge_length\n                 , remove_fakes\n                 , unique_y_pos\n                 , filter_by_year\n                   // shapes:\n                 , add_rings\n                 , add_ring_labels\n                 , copy_edges\n                 , copy_nodes\n                 , add_node_labels\n                 , add_edge_labels\n                   // rendering:\n                 , clear_it\n                 , draw_it\n                 , draw_metadata\n                 )\n\n  word_pipe = pipe( get_actions\n                  , filter_actions\n                  , make_sentences\n                  , write_sentences\n                  )\n}\n\nfunction render() {\n  // TODO: cloning is inefficient: make lazy subgraphs\n  var env = {data: Dagoba.clone(G), params: {my_maxyear: state.my_maxyear, my_minyear: state.my_minyear}, shapes: [], ctx: ctx}\n\n  viz_pipe(env)\n  word_pipe(env)\n\n  // if(n === undefined)\n  //   state.pipelines.forEach(function(pipeline) { pipeline(env) })\n  // else\n  //   state.pipelines[n](env)\n}\n\n\n\n// COMPACTIONS\n\nfunction sg_compact(g) {\n  // so... this is pretty silly i guess or something. use subgraphs instead.\n  var newg = Dagoba.graph()\n  var edges = []\n\n  g.v().run().forEach(function(node) {\n    if(node.time)\n      return undefined\n\n    var others = g.v(node._id).both().run()\n    others.forEach(function(other) {\n      if(other.time)\n        node.time = Math.min(node.time||Infinity, other.time)\n\n      var oo = g.v(other._id).both().run()\n      if(oo.length < 2)\n        return undefined\n\n      var edge = {_in: oo[0]._id, _out: oo[1]._id, label: other.name || \"\"}\n      edges.push(edge)\n      newg.addVertex(node)\n    })\n  })\n\n  edges.forEach(function(edge) {\n    newg.addEdge(edge)\n  })\n\n  return newg\n}\n\nfunction likenamed(g) {\n  var namemap = {}\n\n  g.v().run().forEach(function(node) {\n    if(!node.name)\n      return undefined\n\n    if(!namemap[node.name]) {\n      namemap[node.name] = [node]\n    }\n    else {\n      namemap[node.name].push(node)\n    }\n  })\n\n  Object.keys(namemap).forEach(function(name) {\n    if(namemap[name].length > 1)\n      g.mergeVertices(namemap[name])\n  })\n\n  return g\n}\n\n\n\n/// modularize this:\n\nlet clusters = [ ['AMC', 'amc', 'Allied Media Conference', 'allied media conference', 'Allied media Conference']\n              , ['AMP', 'amp', 'Allied Media Projects', 'allied media projects']\n              , ['AMC2016 Coordinators Weekend', 'AMC 2016 Coordinators Meeting']\n              , ['jayy dodd', 'jayy']\n              ]\n\nfunction cluster(g) {\n  clusters.map(function(names) {\n    return names.reduce(function(acc, name) {\n      return acc.concat(g.v({name: name}).run())\n    }, [])\n  }).forEach(g.mergeVertices.bind(g))\n\n  return g\n}\n\n// LAYOUT\n\nfunction mod(prop, fun) {\n  return function(env) {\n    env[prop] = fun(env[prop])\n    return env\n  }\n}\n\nfunction set_year(env) {\n  var minyear = Infinity\n  var maxyear = 0\n  var list = env.params.years = {}\n\n  env.data.V = env.data.V.map(function(node) {\n\n    if(node.time < 1199161600000) return node // HACK: remove me!!!\n\n    var year = (new Date(node.time+100000000)).getFullYear()\n    if(year < minyear) minyear = year // effectful :(\n    if(year > maxyear) maxyear = year // effectful :(\n\n    node.year = year // mutation :(\n    push_it(list, node.year, node) //, G.vertexIndex[node._id])\n\n    return node\n  })\n\n  // env.params.minyear = minyear\n  // env.params.maxyear = maxyear\n  env.params.minyear = state.my_minyear\n  env.params.maxyear = state.my_maxyear\n\n  return env\n}\n\nfunction data_to_graph(env) {\n  // THINK: this is kind of weird... we could probably get more leverage by just using G itself\n  env.params.graph = Dagoba.graph(env.data.V, env.data.E)\n  env.data.V = env.params.graph.vertices\n  env.data.E = env.params.graph.edges\n  return env\n}\n\nfunction add_fakes(env) {\n  var years = env.params.years\n\n  Object.keys(years).forEach(function(yearstr) {\n    var year = years[yearstr]\n    var fake = {type: 'fake', year: yearstr, name: 'fake', _in: [], _out: []}\n    // var copies = 3 + Math.ceil(year.length / 5)\n    var copies = 10 - year.length < 0 ? 2 : 10 - year.length\n    // var fakes = [clone(fake), clone(fake), clone(fake), clone(fake), clone(fake), clone(fake), clone(fake), clone(fake)]\n    var fakes = []\n    for(var i = 0; i < copies; i++) {\n      fakes.push(clone(fake))\n    }\n\n    Array.prototype.push.apply(year, fakes)\n    Array.prototype.push.apply(env.data.V, fakes)\n  })\n\n  return env\n}\n\nfunction set_coords(env) {\n  var years = env.params.years\n\n  env.data.V.forEach(function(node) {\n    if(node.x) return node\n\n    var offset = node.year - env.params.my_minyear + 1\n    var radius = offset * state.ring_radius // HACK: remove this!\n\n    var nabes = years[node.year]\n    // var gnode = G.vertexIndex[node._id]\n\n    if(!nabes) return false\n\n    var index = nabes.indexOf(node)\n    var arc = 2 * Math.PI / nabes.length\n\n    var deg = offset + index * arc\n    var cx  = radius * Math.cos(deg)\n    var cy  = radius * Math.sin(deg)\n    var edge_count = node._in.length + node._out.length\n\n    node.shape = 'circle'\n    node.x = cx\n    node.y = cy\n    node.r = 4 + 2*Math.min(5, edge_count / 2) //Math.floor(node.name.charCodeAt(0)/20)\n\n    return node\n  })\n\n  return env\n}\n\nfunction set_score(env) {\n  env.data.V = env.data.V.map(function(node) { node.score = score(node); return node })\n  return env\n}\n\nfunction minimize_edge_length(env) {\n  var years = env.params.years\n\n  Object.keys(years).sort().forEach(function(key) {\n    var peers = years[key]\n    peers.sort(score_sort)\n    peers.forEach(function(node) {\n      peers.forEach(function(peer) {\n        swap(node, peer)\n        var new_node_score = score(node)\n        var new_peer_score = score(peer)\n        if(node.score + peer.score < new_node_score + new_peer_score) {\n          swap(node, peer)\n        } else {\n          node.score = new_node_score\n          peer.score = new_peer_score\n        }\n      })\n    })\n  })\n\n  return env\n\n  function swap(n1, n2) {\n    var x = n1.x, y = n1.y\n    n1.x = n2.x; n1.y = n2.y\n    n2.x = x;    n2.y = y\n  }\n\n  function score_sort(n1, n2) {\n    return n1.score - n2.score\n  }\n}\n\nfunction score(node) {\n  return [].concat(node._in||[], node._out||[]).reduce(function(acc, edge) {return acc + score_edge(edge, node)}, 0)\n\n  function score_edge(edge, self) {\n    //// TODO: if other end is \"older\" than this end, don't count it...\n    if(edge._in  === node && edge._out.year > node.year) return 0\n    if(edge._out === node && edge._in. year > node.year) return 0\n\n    // return edge._in.x + edge._out.x\n\n    var dx = Math.abs(edge._in.x - edge._out.x)\n    var dy = Math.abs(edge._in.y - edge._out.y)\n\n    return Math.sqrt(dx*dx + dy*dy)\n  }\n}\n\nfunction remove_fakes(env) {\n  env.data.V = env.data.V.filter(function(node) {\n    return node.type !== 'fake'\n  })\n  return env\n}\n\nfunction unique_y_pos(env) {\n  var threshold = 6\n  // var node_radius = 5\n  var arc = Math.PI / 100\n  var years = env.params.years\n  var ys = []\n\n  Object.keys(years).sort().forEach(function(key) {\n    var peers = years[key]\n    peers.forEach(function(node) {\n      var coords, closest\n\n      if(node.type === 'fake') // le sigh\n        return\n\n      // A) do a binary search on an array of midpoints to find the closest one\n      // B) if it's within threshold walk around the circle in both directions until you find an opening\n      // C) if you reach the antipode give up\n\n      for(var da = arc; da < Math.PI; da = -1*(da + arc*(da/Math.abs(da)))) {\n        coords = modify_coords(node, da)\n        closest = find_closest(coords.y, ys)\n        if(!closest || Math.abs(closest - coords.y) > threshold)\n          break\n      }\n\n      // console.log(da, closest, coords.y, Math.abs(closest - coords.y))\n\n      node.x = coords.x\n      node.y = coords.y\n      ys.push(coords.y)\n\n      ys.sort(function(a, b) {return a - b}) // OPT: just insert coords.y in place\n    })\n  })\n\n  return env\n\n  function modify_coords(node, da) {\n    return { x: node.x * Math.cos(da) - node.y * Math.sin(da)\n           , y: node.x * Math.sin(da) + node.y * Math.cos(da)\n           }\n  }\n\n  function find_closest(n, ns) { // binary search\n    var closest\n    var index = Math.floor(ns.length / 2)\n    var item = ns[index]\n\n    if(ns.length < 5) {\n      for(var i = 0; i < ns.length; i++) {\n        if(closest === undefined || Math.abs(ns[i] - n) < Math.abs(closest - n))\n          closest = ns[i]\n      }\n      return closest\n    }\n\n    if(item === n)\n      return item\n\n    if(item > n)\n      return find_closest(n, ns.slice(0, index))\n\n    return find_closest(n, ns.slice(index + 1))\n  }\n}\n\nfunction filter_by_year(env) {\n  var max = env.params.my_maxyear\n  var min = env.params.my_minyear\n\n  // hack hack hack\n  if(state.current_year < max)\n    max = state.current_year\n\n  // TODO: do this in Dagoba so we can erase edges automatically\n  env.data.V = env.data.V.filter(function(node) {\n    // yuckyuckyuck\n    if(node.year > max || node.year < min) {\n      env.params.graph.removeVertex(node)\n      return false\n    }\n    return true\n  })\n  return env\n}\n\n\n// SHAPES\n\nfunction add_rings(env) {\n  for(var i = env.params.minyear; i <= env.params.maxyear; i++) {\n    var color = i === state.current_year ? '#999' : '#ccc'\n    var radius = state.ring_radius * (i - env.params.my_minyear + 1)\n    env.shapes.unshift({shape: 'circle', x: 0, y: 0, r: radius, stroke: color, fill: 'white', line: 1, type: 'ring', year: i})\n  }\n  return env\n}\n\nfunction add_ring_labels(env) {\n  var labels = []\n\n  env.shapes.filter(eq('type', 'ring')).forEach(function(shape) {\n    var fill = shape.year === state.current_year ? '#999' : '#ccc'\n    var label = {shape: 'text', str: shape.year, x: -15, y: -shape.r - 5, fill: fill, font: \"18px Raleway\" }\n    labels.push(label)\n  })\n\n  env.shapes = env.shapes.concat(labels)\n  return env\n}\n\nfunction copy_edges(env) {\n  env.data.E.forEach(function(edge) {\n    if(!state.all_edges && !(edge._out.year === state.current_year || edge._in.year === state.current_year)) // HACK: remove this\n      return undefined\n\n    var label = edge.label || \"777\"\n    var color = str_to_color(label)\n\n    // function str_to_color(str) { return 'hsl' + (state.show_labels?'a':'') + '(' + str_to_num(str) + ',100%,40%' + (state.show_labels?',0.3':'') + ')';}\n    function str_to_color(str) { return 'hsla' + '(' + str_to_num(str) + ',30%,40%,0.' + (state.show_labels?'3':'7') + ')' }\n    function str_to_num(str) { return char_to_num(str, 0) + char_to_num(str, 1) + char_to_num(str, 2) }\n    function char_to_num(char, index) { return (char.charCodeAt(index) % 20) * 20 }\n\n    var line = {shape: 'line', x1: edge._in.x, y1: edge._in.y, x2: edge._out.x, y2: edge._out.y, stroke: color, type: 'edge', label: label}\n    env.shapes.push(line)\n  })\n  return env\n}\n\nfunction copy_nodes(env) {\n  env.shapes = env.shapes.concat.apply(env.shapes, env.data.V.map(function(node) {\n    // HACK: move this elsewhere\n    if(!state.all_edges) {\n      var ghost = !node._in.concat(node._out)\n                       .map(e => [e._in.year, e._out.year])\n                       .reduce((acc, t) => acc.concat(t), [])\n                       .filter(y => y === state.current_year).length\n      if(ghost)\n        return []\n    }\n\n    // var this_year = state.all_edges || node.year === state.current_year\n    // var color =  'hsla(0,0%,20%,0.' + (this_year ? '99' : '3') + ')'\n\n    // Person: Blue\n    // Org: Green\n    // Event: Magenta\n    // Outcome: Orange\n    // Concept: Purple\n    // Labels should be black\n    // Connections should be grey\n    var hues = { outcome: '40'\n               // , action '20'\n               , person: '240'\n               , event: '320'\n               , org: '100'\n               }\n\n    var color = 'hsla(' + hues[node.type] + ',80%,50%,0.99)'\n\n    var shape = { shape: 'circle'\n                , x: node.x\n                , y: node.y\n                , r: node.r\n                , name: node.name\n                , fill: color\n                }\n\n    if(!node.highlight)\n      return shape\n\n    var highlight = { shape: 'circle'\n                    , x: node.x\n                    , y: node.y\n                    , r: node.r + 12\n                    , line: 0.01\n                    , fill: 'hsla(0, 80%, 50%, 0.20)'\n                    }\n\n    return [highlight, shape]\n  }))\n  return env\n}\n\nfunction add_node_labels(env) {\n  var labels = []\n\n  env.shapes.forEach(function(shape) {\n    if(!shape.name) return undefined\n    var str = truncate(shape.name, 50)\n    var label = {shape: 'text', str: str, x: shape.x + 15, y: shape.y + 5}\n    labels.push(label)\n  })\n\n  env.shapes = env.shapes.concat(labels)\n  return env\n}\n\nfunction add_edge_labels(env) {\n  if(!state.show_labels)\n    return env\n\n  var labels = []\n\n  env.shapes.forEach(function(shape) {\n    if(shape.type !== 'edge') return undefined\n    var label = {shape: 'angle_text', x1: shape.x1, y1: shape.y1, x2: shape.x2, y2: shape.y2, fill: shape.stroke, str: shape.label}\n    labels.push(label)\n  })\n\n  env.shapes = env.shapes.concat(labels)\n  return env\n}\n\n// RENDERING\n\nfunction clear_it(env) {\n  env.ctx.clearRect(0, 0, 1000, 1000)\n  return env\n}\n\nfunction draw_it(env) {\n  env.shapes.forEach(function(node) {\n    draw_shape(env.ctx, node)\n  })\n  return env\n}\n\nfunction draw_metadata(env) {\n  // el('minyear').textContent = 1900 + env.params.minyear\n  // el('maxyear').textContent = 1900 + state.current_year\n  return env\n}\n\n\n// CANVAS FUNCTIONS\n\nfunction draw_shape(ctx, node) {\n  var cx = 450\n  var cy = 450\n\n  if(node.shape === 'circle')\n    draw_circle(ctx, cx + node.x, cy + node.y, node.r, node.stroke, node.fill, node.line)\n\n  if(node.shape === 'line')\n    draw_line(ctx, cx + node.x1, cy + node.y1, cx + node.x2, cy + node.y2, node.stroke, node.line)\n\n  if(node.shape === 'text')\n    draw_text(ctx, cx + node.x, cy + node.y, node.str, node.font, node.fill)\n\n  if(node.shape === 'angle_text')\n    draw_angle_text(ctx, cx + node.x1, cy + node.y1, cx + node.x2, cy + node.y2, node.str, node.font, node.fill)\n}\n\nfunction draw_circle(ctx, x, y, radius, stroke_color, fill_color, line_width) {\n  ctx.beginPath()\n  ctx.arc(x, y, radius, 0, Math.PI*2, false)\n  ctx.fillStyle = fill_color || '#444444'\n  ctx.fill()\n  ctx.lineWidth = line_width || 2\n  ctx.strokeStyle = stroke_color || '#eef'\n  ctx.stroke()\n}\n\nfunction draw_line(ctx, fromx, fromy, tox, toy, stroke_color, line_width) {\n  var path=new Path2D()\n  path.moveTo(fromx, fromy)\n  path.lineTo(tox, toy)\n  ctx.strokeStyle = stroke_color || '#eef'\n  ctx.lineWidth = line_width || 0.5\n  ctx.stroke(path)\n}\n\nfunction draw_text(ctx, x, y, str, font, fill_color) {\n  ctx.fillStyle = fill_color || '#000'\n  ctx.font = font || \"14px Raleway\"\n  if(isNaN(x)) return undefined\n  x = x || 0\n  y = y || 0\n  ctx.fillText(str, x, y)\n}\n\nfunction draw_angle_text(ctx, x1, y1, x2, y2, str, font, fill_color) {\n  ctx.fillStyle = fill_color || '337'\n  ctx.font = font || \"14px sans-serif\"\n\n  // modified from http://phrogz.net/tmp/canvas_rotated_text.html\n\n  var padding = 5\n  var dx = x2 - x1\n  var dy = y2 - y1\n  var len = Math.sqrt(dx*dx+dy*dy)\n  var avail = len - 2*padding\n  var pad = 1/2\n  var x = x1\n  var y = y1\n\n  var textToDraw = str\n  if (ctx.measureText && ctx.measureText(textToDraw).width > avail){\n    while (textToDraw && ctx.measureText(textToDraw+\"…\").width > avail) textToDraw = textToDraw.slice(0, -1)\n    textToDraw += \"…\"\n  }\n\n  // Keep text upright\n  var angle = Math.atan2(dy, dx)\n  if (angle < -Math.PI/2 || angle > Math.PI/2){\n    x = x2\n    y = y2\n    dx *= -1\n    dy *= -1\n    angle -= Math.PI\n  }\n\n  ctx.save()\n  ctx.textAlign = 'center'\n  ctx.translate(x+dx*pad, y+dy*pad)\n  ctx.rotate(angle)\n  ctx.fillText(textToDraw, 0, -3)\n  ctx.restore()\n}\n\n\n\n// SENTENCE STRUCTURES\n\nfunction get_actions(env) {\n  var actions = G.v({cat: 'action'}).run() // FIXME: use env.data, not G\n  env.params.actions = actions\n  return env\n}\n\nfunction filter_actions(env) {\n  env.params.actions = env.params.actions.map(function(action) {\n    action.year = new Date(action.time+100000000).getFullYear()\n    return action\n  })\n\n  if(!state.filter_sentences) return env\n\n  env.params.actions = env.params.actions.filter(function(action) {\n    return action.year === state.current_year\n  })\n\n  return env\n}\n\n\nfunction make_sentences(env) {\n  var sentences = env.params.actions.map(construct).filter(Boolean)\n  env.params.sentences = sentences\n  return env\n}\n\nfunction construct(action) {\n  var list = []\n  var edges = action._out.concat(action._in)\n  if(!edges[1]) return false\n  if(edges[0].label === 'the')\n    edges = [edges[1], edges[0]]\n  function notme(id, edge) { return edge._in._id === id ? edge._out : edge._in }\n  list.push(notme(action._id, edges[0]), edges[0], action, edges[1], notme(action._id, edges[1]))\n  list.year = action.year\n  return list\n}\n\nfunction write_sentences(env) {\n  dom.set_el('sentences', '')\n  var oldyear = 1\n\n  env.params.sentences.sort(function(a, b) {\n    return a.year - b.year\n  })\n\n  env.params.sentences.forEach(function(list) {\n    var sentence = ''\n    var innerwords = ''\n    var highlight_count = 0\n\n    if(list.year !== oldyear) {\n      sentence = '<h2>' + list.year + '</h2>'\n      oldyear = list.year\n    }\n\n    list.forEach(function(thing) {\n      var data\n      var word = thing.name || thing.label\n      var cat = thing.cat\n      var type = cat ? thing.type : 'edge'\n\n      var classes = [type]\n      if(cat) {\n        classes.push(cat)\n        classes.push('node-' + thing._id)\n      }\n      else {\n        classes.push('node-' +  thing._in._id + '-' + thing._out._id)\n      }\n\n      if(thing.highlight)\n        highlight_count++\n\n      if(type !== 'edge')\n        data = {id: thing._id||''}\n      else\n        data = {id1: thing._in._id, id2: thing._out._id}\n\n      if(!state.admin_mode)\n        innerwords += template(classes, data, word)\n      else\n        innerwords += admin_template(thing, type, cat, word)\n    })\n\n    var sentence_classes = 'sentence'\n    sentence_classes += highlight_count === 3 ? ' highlight' : ''\n    sentence += '<p class=\"' + sentence_classes + '\">' + innerwords + '.</p>'\n\n    dom.append_el('sentences', sentence)\n  })\n\n  function template(classes, data, text) {\n    classes.unshift('word')\n    var classtext = classes.join(' ')\n\n    var datatext = Object.keys(data).map(function(key) {return 'data-' + key + '=\"' + data[key] + '\"'}).join(' ')\n\n    return ' <span class=\"' + classtext + '\"'\n         + datatext\n         + ' contentEditable=\"true\">'\n         + text + '</span>'\n  }\n\n  function admin_template(thing, type, cat, text) {\n    var button = ''\n    var notes = ''\n\n    if(cat === 'action') {\n      button = '<button class=\"delete\" data-id=\"'+thing._id+'\">delete just this sentence</button>'\n    }\n    else if(type !== 'edge') {\n      notes = ' (' + type + ')'\n      button = '<button class=\"delete\" data-id=\"'+thing._id+'\">delete this thing and all its sentences entirely</button>'\n    }\n\n    return ' ' + text + notes + button\n  }\n\n  return env\n}\n\n\n\n\n// FORM BUILDER & FRIENDS\n\nfunction whatsnext(graph, conversation) {\n  // TODO: incorporate graph knowledge (graph is the whole world, or the relevant subgraph)\n  // THINK: what is a conversation?\n  // are we currently in a sentence? then find the highest weighted unfilled 'port'\n\n  render_conversation(conversation)\n}\n\nfunction get_cat_dat(cat, q) {\n  var substrRegex = new RegExp(q, 'i')\n  var frontRegex = new RegExp('^' + q, 'i')\n  var nodes = G.vertices.filter(function(node) {return node.cat === cat}).map(prop('name'))\n        .filter(function(name) {return substrRegex.test(name)})\n\n  nodes.sort(function(a, b) {\n    return frontRegex.test(b) - frontRegex.test(a) || a.charCodeAt() - b.charCodeAt()\n  })\n\n  return nodes\n}\n\nfunction render_conversation(conversation) {\n  var typeahead_params = {hint: true, highlight: true, minLength: 1}\n  function typeahead_source(cat) {return {name: 'states', source: function(q, cb) {cb(get_cat_dat(cat, q))}}}\n\n  var inputs = ''\n  var prelude = ''\n  var submit_button = '<input type=\"submit\" style=\"position: absolute; left: -9999px\">'\n\n  // special case the first step\n  var sentence = conversation.current\n\n  sentence.filled.forEach(function(slot, i) {\n    prelude += inject_value(slot, slot.value, i) + ' '\n  })\n\n  // display the unfilled slot\n  var slot = sentence.slots[0]\n  var input = ''\n  if(slot.type === 'word') {\n    input = inject_value(slot, make_word_input(slot.cat, slot.key))\n  }\n  else if(slot.type === 'gettype') {\n    input = inject_value(slot, make_type_input(slot.cat, slot.key))\n  }\n  else if(slot.type === 'date') {\n    input = inject_value(slot, make_date_input(slot.key))\n  }\n\n  prelude += input\n\n\n  // do the DOM\n  dom.set_el('the-conversation', prelude + inputs + submit_button)\n\n  // wiring... /sigh\n  var catnames = Object.keys(cats)\n  catnames.forEach(function(cat) {\n    $('.'+cat+'-input').typeahead(typeahead_params, typeahead_source(cat))\n  })\n\n  if(sentence.filled.length)\n    $('#' + slot.key).focus()\n\n  return false\n\n  // helper functions\n\n  function make_word_input(cat, key) {\n    var text = ''\n\n    if(cat === 'thing')\n      return '<input class=\"typeahead ' +cat+ '-input\" type=\"text\" placeholder=\"A' +mayben(cat)+ ' ' +cat+ '\" id=\"' +key+ '\">'\n    if(cat === 'action') {\n      text += '<select id=\"verb\" name=\"verb\">'\n      var options = ['participate in', 'lead', 'fund', 'organize', 'inspire', 'invite']\n      // var options = ['facilitate', 'coordinate', 'contribute', 'create', 'attend', 'manage', 'assist', 'present', 'join', 'leave']\n      options.forEach(function(option) {\n        text += '<option>' + option + '</option>'\n      })\n      text += '</select>'\n      return text\n    }\n  }\n\n  function make_type_input(cat, key) {\n    // TODO: this assumes cat is always 'thing'\n    var str = '<select id=\"'+key+'\">'\n    str += '<option value=\"person\">person</option>'\n    str += '<option value=\"org\">org</option>'\n    str += '<option value=\"event\">event</option>'\n    str += '<option value=\"outcome\">outcome</option>'\n    str += '</select>'\n    return str\n  }\n\n  function make_date_input(key) {\n    var str = '<input id=\"' +key+ '\" type=\"date\" name=\"' +key+ '\" value=\"2016-01-01\" />'\n    return str\n  }\n\n  function inject_value(slot, value, index) { // HACK: index is a huge hack, remove it.\n    var text = ''\n\n    if(slot.key === 'subject') {\n      if(slot.value) {\n        text += '<p><b>' + slot.value + '</b></p>'\n      } else {\n        text += \"Okay, let's fill in the blanks. Tell us about \"\n        text += value + ' '\n      }\n    }\n    else if(slot.key === 'verb') {\n      text += ' did '\n      text += value\n      text += ' the '\n    }\n    else if(slot.key === 'object') {\n      text += value + ' '\n    }\n    else if(slot.type === 'gettype') {\n      if(index === 1) {\n        text += ' is a'\n        text += mayben(value) + ' '\n        text += value + ' '\n        if(slot.value)\n          text += slot.value === 'person' ? 'who ' : 'which '\n      } else {\n        text += ' (a'\n        text += mayben(value) + ' '\n        text += value + ') '\n      }\n    }\n    else if(slot.type === 'date') {\n      text += ' in/on '\n      text += value + ' '\n    }\n    else {\n      text = ' ' + value + ' '\n    }\n\n    return text\n  }\n}\n\nfunction mayben(val) {\n  return /^[aeiou]/.test(val) ? 'n' : ''\n}\n\n\nfunction set_minus(xs, ys) {\n  return xs.filter(function(x) {\n    return ys.indexOf(x) === -1\n  })\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction showtags() {\n  // generate current tags\n  // hoverable span for highlight, plus clickable for remove\n  var tagwrapper = ['<span class=\"tag\">', '</span>']\n  var tagstr = state.tags.map(function(tag) { return tagwrapper[0] + tag + tagwrapper[1] }).join(', ')\n  dom.set_el('tagnames', tagstr)\n\n  // generate select box\n  var unused = set_minus(Object.keys(state.tagkeys), state.tags).sort()\n  var optionstr = '<option>' + unused.join('</option><option>') + '</option>'\n  dom.set_el('othertags', optionstr)\n}\n\n\nfunction render_all() {\n  render()\n  render_conversation(conversation)\n  showtags()\n}\n","/*global Dagoba */\n\nimport state from './state'\nimport {get_facts_from_server} from 'net'\nimport {add_edge} from 'model'\nimport {render_all} from 'render'\n\nexport let G = Dagoba.graph()\nexport {addtag, removetag, add_data}\n\n\nfunction addtag(tag) {\n  state.tags.push(tag)\n  G = Dagoba.graph()\n  fact_to_graph(state.facts)\n  render_all()\n}\n\nfunction removetag(tag) {\n  var index = state.tags.indexOf(tag)\n  if(index === -1)\n    return undefined\n\n  state.tags.splice(index, 1)\n  G = Dagoba.graph()\n  fact_to_graph(state.facts)\n  render_all()\n}\n\n// function reset_graph() {\n//   G = Dagoba.graph()\n// }\n\nfunction add_data(cb) {\n  get_facts_from_server(function(facts) {\n    cb(fact_to_graph(capture_facts(facts)))\n  })\n}\n\nfunction capture_facts(facts) {\n  state.facts = facts\n  return facts\n}\n\nfunction fact_to_graph(facts) {\n  /*\n\n   data model:\n   user: id\n   action: add/remove/edit\n   type: node/edge\n   tags: [...]\n   org: id\n   [maybe other stats can live here?]\n   data:\n   node: {id, name, type, cat...}\n   edge: {_in, _out, type, label}\n\n   */\n\n  var tree = factor_facts(filter_facts(facts))\n  state.tagkeys = get_tagkeys(facts)\n\n  tree.nodes.add.forEach(function(node) {\n    var fun = window['add_' + node.cat] // FIXME: ugh erk yuck poo\n    if(!fun) return undefined\n    fun(node.type, node)\n  })\n\n  tree.edges.add.forEach(function(edge) { // we need to delay these so the nodes are all in place (sometimes the facts get added in weird orders)\n    add_edge(edge.type, edge._out, edge._in, edge)\n  })\n\n  tree.nodes.edit.forEach(function(node) {\n    // FIXME: what on earth is this??? should it be G.edit?\n    // RM.graph.edit(node) //////\n  })\n}\n\nfunction get_tagkeys(facts) {\n  var keys = {}\n  facts.forEach(function(fact) {\n    ~(fact.tags||[]).forEach(function(tag) {\n      keys[tag] = true\n    })\n  })\n  return keys\n}\n\nfunction filter_facts(facts) {\n  facts = facts.filter(function(fact) {\n    return !!set_intersect(fact.tags, state.tags).length // THINK: this implies no empty tag arrays (so 'plain' as default?)\n  })\n\n  return facts\n}\n\nfunction factor_facts(facts) {\n  var tree = {nodes: {add: [], edit: [], remove: []}, edges: {add: [], edit: [], remove: []}}\n  facts.forEach(function(fact) {\n    // var branch = tree[fact.type+'s']\n    // var list = branch[fact.action] || []\n    // if(!branch[fact.action])\n    //   branch[fact.action] = list\n    var list = tree[fact.type+'s'][fact.action] // TODO: error handling\n\n    // var item = clone(fact.data)\n    var item = fact.data // THINK: is mutating here okay?\n    item.org = fact.org\n    item.user = fact.user\n    item.tags = fact.tags\n    list.push(item)\n  })\n  return tree\n}\n\nfunction set_intersect(xs, ys) {\n  return xs.filter(function(x) {\n    return ys.indexOf(x) !== -1\n  })\n}\n","import {add_data} from './graph'\nimport {init as render_init, render, render_all} from 'render'\nimport * as dom from 'dom' // just for effects\nimport state from 'state'\n\n\n\n\n\n\n///////////////////////// DOM GLUE ///////////////////////////////\n\n\n\n\n\n// dom.el('login').addEventListener('submit', dom.login)\n\n// dom.el('addtag').addEventListener('submit', dom.submit_addtag)\n\n// dom.el('the-conversation').addEventListener('submit', dom.submit_convo)\n\n// dom.el('sentences').addEventListener('mouseover', dom.activate_highlighter)\n// dom.el('sentences').addEventListener('mouseout', dom.deactivate_highlighter)\n// dom.el('sentences').addEventListener('keyup', dom.keyup_sentences)\n// dom.el('sentences').addEventListener('click', dom.click_sentences)\n\n// dom.el('tagnames').addEventListener('click', dom.click_tagnames)\n// dom.el('tagnames').addEventListener('mouseover', dom.mouseover_tagnames)\n// dom.el('tagnames').addEventListener('mouseout', dom.mouseout_tagnames)\n\n\n// document.addEventListener('keydown', dom.global_keydown)\n\n\n\n\n\n\n///////////////////// END DOM GLUE ///////////////////////////////\n\n\n\n\n\n\n\n\n\n\n// package and expose some functionality for the view side,\n// and create outward-facing bindings to spin everything up.\n\n\n// init network load\n// expose rendering functions\n// create dom hooks on demand as html is rendered\n\n\n\n\n\n// TODO: partition incoming bleep bloops by action\n// TODO: build edit functions\n// TODO: build remove functions\n// TODO: ask user for email address\n// TODO: show current tags\n// TODO: allow changing of tags\n// TODO: allow multitag views\n// TODO: add all tags on server\n// TODO: try to get an additional compaction in\n\n// TODO: consolidate like-named nodes\n// TODO: consolidate email addresses on server\n// TODO: copy tags into url\n\n\n\n\n\n\n\n\n\n// INIT\n\n\n// TODO: break this up a little so the logic is clearer\n\nfunction init() {\n  if(window.location.host === \"127.0.0.1\") {\n    if(window.location.hash)\n      state.safe_mode = window.location.hash.slice(1)\n    else\n      state.safe_mode = true\n  }\n\n  if(window.location.search) {\n    state.query = window.location.search.substr(1).split('&').reduce(function(acc, pair) {\n      var p = pair.split('=')\n      acc[p[0]] = p[1]\n      return acc\n    }, {})\n    if(state.query.tag)\n      state.tags = [state.query.tag]\n    else if(state.query.tags)\n      state.tags = state.query.tags.split('|')\n  }\n\n  // G = Dagoba.graph()\n\n  render_init()\n\n  function cb() {\n    render_all()\n    state.loading = false // TODO: get rid of this somehow\n  }\n\n  add_data(cb)\n\n  setTimeout(function() {\n    render()\n  }, 111)\n}\n\ninit()\n","/**\n * \n * The Entry point to all of Ripplemap. (RM)\n * Creates the sidebar for controlling the RM. (built with Preact, see src/Sidebar)\n * Mounts RM to the dom using `createRippleMap()` \n */\n\nimport { h, render, Component } from 'preact';\nimport Sidebar from './Sidebar/Sidebar'\nimport './main.css'\nimport {createRippleMap} from './Ripplemap/Ripplemap';\nimport '../js/main'\n\n\nrender(<Sidebar />, document.getElementById('sidebar'));\n// createRippleMap()"],"names":["VNode","nodeName","attributes","children","key","stack","EMPTY_CHILDREN","h","lastSimple","child","simple","i","arguments","length","push","pop","Array","String","p","undefined","options","vnode","extend","obj","props","clone","delve","split","isFunction","isString","hashToClassName","c","str","prop","lcCache","toLowerCase","s","resolved","Promise","resolve","defer","then","f","setTimeout","NO_RENDER","SYNC_RENDER","FORCE_RENDER","ASYNC_RENDER","EMPTY","ATTR_KEY","Symbol","for","NON_DIMENSION_PROPS","boxFlexGroup","columnCount","fillOpacity","flex","flexGrow","flexShrink","flexNegative","fontWeight","lineClamp","lineHeight","order","orphans","strokeOpacity","widows","zIndex","zoom","NON_BUBBLING_EVENTS","blur","error","focus","load","resize","scroll","createLinkedState","component","eventPath","path","e","t","target","state","v","type","match","checked","value","setState","items","enqueueRender","_dirty","debounceRendering","rerender","list","renderComponent","isFunctionalComponent","prototype","render","buildFunctionalComponent","context","getNodeProps","isSameNodeType","node","Text","_componentConstructor","isNamedNode","normalizedNodeName","defaultProps","removeNode","parentNode","removeChild","setAccessor","name","old","isSvg","className","style","cssText","innerHTML","__html","l","_listeners","substring","addEventListener","eventProxy","removeEventListener","removeAttribute","ns","removeAttributeNS","setAttributeNS","setAttribute","setProperty","event","nodes","collectNode","Element","_component","createNode","document","createElementNS","createElement","mounts","diffLevel","isSvgMode","hydrating","flushMounts","afterMount","componentDidMount","diff","dom","mountAll","parent","componentRoot","ownerSVGElement","ret","idiff","appendChild","ref","nodeValue","recollectNodeTree","createTextNode","buildComponentFromVNode","out","vchildren","firstChild","replaceChild","fc","a","nextSibling","dangerouslySetInnerHTML","prevSvgMode","innerDiffNode","absorb","originalChildren","childNodes","keyed","keyedLen","min","len","childrenLen","vlen","j","vchild","__key","insertBefore","unmountOnly","lastChild","diffAttributes","attrs","components","collectComponent","constructor","createComponent","Ctor","inst","call","nextBase","splice","setComponentProps","opts","_disable","__ref","base","componentWillMount","componentWillReceiveProps","prevContext","prevProps","syncComponentUpdates","isChild","skip","rendered","previousProps","previousState","prevState","previousContext","isUpdate","initialBase","initialChildComponent","cbase","shouldComponentUpdate","componentWillUpdate","getChildContext","childComponent","toUnmount","childProps","_parentComponent","baseParent","componentRef","unshift","componentDidUpdate","afterUpdate","cb","_renderCallbacks","fn","originalComponent","oldDom","isDirectOwner","isOwner","unmountComponent","remove","beforeUnmount","componentWillUnmount","inner","componentDidUnmount","Component","_linkedStates","callback","merge","classMaker","b","class_1","class_2","Tab","id","currentView","icon","changeView","tabClasses","iconClasses","tabs","TabBar","renderTabs","map","tab","Header","genClassName","Button","onClick","Home","About","YourSelection","Current","Legend","Story","Sidebar","view_id","renderSelectedView","tags","facts","tagkeys","query","safe_mode","loading","all_edges","admin_mode","my_maxyear","my_minyear","show_labels","current_year","filter_sentences","ring_radius","add_to_server_facts","live_item","item","Object","keys","reduce","acc","indexOf","_out","_id","_in","fact","email","persist","send_data_to_server","data","url","console","log","G","method","JSON","stringify","response","json","result","get_facts_from_server","parse","localStorage","catch","err","eq","attr","val","truncate","to","substr","push_it","pipe","all_funs","slice","magic_pipe","funs","fun","shift","async","new_data","mess","cats","thing","action","effect","happening","add_alias","catstr","typestr","alias","cat","aliases","new_thing_type","properties","cattype","cc","start","end","forEach","new_action_type","edges","did","dir","plural","label","types","the","new_effect_type","by","was","during","new_happening_type","at","add_edge","from","edge","convert_props","timerange","add_to_graph","get_new_id","addVertex","addEdge","Math","random","isArray","convo","new_conversation","new_sentence","slots","filled","sentence","sentences","current","el","els","el_id","getElementById","set_el","append_el","ctx","getContext","viz_pipe","word_pipe","init","mod","sg_compact","likenamed","cluster","Dagoba","cloneflat","set_year","data_to_graph","add_fakes","set_coords","set_score","minimize_edge_length","remove_fakes","unique_y_pos","filter_by_year","add_rings","add_ring_labels","copy_edges","copy_nodes","add_node_labels","add_edge_labels","clear_it","draw_it","draw_metadata","get_actions","filter_actions","make_sentences","write_sentences","env","params","shapes","g","newg","graph","run","time","others","both","other","Infinity","oo","namemap","mergeVertices","clusters","names","concat","bind","minyear","maxyear","years","V","year","Date","getFullYear","E","vertices","yearstr","fake","copies","fakes","apply","x","offset","radius","nabes","index","arc","PI","deg","cx","cos","cy","sin","edge_count","shape","y","r","score","sort","peers","score_sort","peer","new_node_score","new_peer_score","swap","n1","n2","score_edge","self","dx","abs","dy","sqrt","filter","threshold","ys","coords","closest","da","modify_coords","find_closest","n","floor","max","removeVertex","color","stroke","fill","line","labels","font","str_to_color","str_to_num","char_to_num","char","charCodeAt","x1","y1","x2","y2","ghost","hues","outcome","person","highlight","clearRect","draw_shape","draw_circle","draw_line","draw_text","draw_angle_text","stroke_color","fill_color","line_width","beginPath","fillStyle","lineWidth","strokeStyle","fromx","fromy","tox","toy","Path2D","moveTo","lineTo","isNaN","fillText","padding","avail","pad","textToDraw","measureText","width","angle","atan2","save","textAlign","translate","rotate","restore","actions","construct","Boolean","notme","oldyear","innerwords","highlight_count","word","classes","id1","id2","template","admin_template","sentence_classes","text","classtext","join","datatext","button","notes","get_cat_dat","q","substrRegex","RegExp","frontRegex","test","render_conversation","conversation","typeahead_params","hint","minLength","typeahead_source","source","inputs","prelude","submit_button","slot","inject_value","input","make_word_input","make_type_input","make_date_input","catnames","typeahead","$","mayben","option","set_minus","xs","showtags","tagwrapper","tagstr","tag","unused","optionstr","render_all","add_data","fact_to_graph","capture_facts","tree","factor_facts","filter_facts","get_tagkeys","add","window","edit","set_intersect","org","user","location","host","hash","search","pair"],"mappings":"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"}